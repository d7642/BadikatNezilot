<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CyberScan Pro â€” Web Privacy & Fingerprinting Deep Scan</title>

  <!-- ×¡×’× ×•×Ÿ ×××•×—×“: ×¢×™×¦×•×‘ ×›×”×”, ××§×¦×•×¢×™ ×•××“×•×™×§ â€“ ××•××œ×¥ ×œ×”×¤×¨×™×“ ×œ×§×•×‘×¥ CSS ×—×™×¦×•× ×™ -->
  <style>
    :root{
      --bg:#060709;
      --panel:#0f1216;
      --muted:#98a2ad;
      --accent:#d33b3b;
      --accent2:#1f6feb;
      --good:#39b54a;
      --warn:#ffb86b;
      --bad:#ff5c5c;
      --glass: rgba(255,255,255,0.03);
      --gap:6px;
      font-family: "Segoe UI","Helvetica Neue",Arial,system-ui;
    }
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#050506 0%, var(--bg) 100%);color:#e6eef6; scroll-behavior: smooth;}
    .app{max-width:920px;margin:10px auto;padding:10px}
    header{display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#7b1515);display:flex;align-items:center;justify-content:center;font-weight:900;font-size:16px}
    .brand h1{font-size:18px;margin:0}
    .brand p{margin:0;font-size:12px;color:var(--muted)}
    .controls{display:flex;gap:8px;align-items:center}
    .btn{background:linear-gradient(90deg,var(--accent),#b72626);border:0;padding:12px 18px;border-radius:12px;color:white;font-weight:800;cursor:pointer;transition:transform 0.1s;box-shadow:0 6px 20px rgba(0,0,0,0.4);display:inline-flex;align-items:center;gap:8px}
    .btn:active{transform:scale(0.98)}
    .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:10px 14px;font-weight:700;box-shadow:none}
    .score{display:flex;align-items:center;gap:10px}
    .score .val{font-size:24px;font-weight:900;min-width:40px;text-align:center;}
    .results{margin-top:12px;display:flex;flex-direction:column;gap:8px}
    .card{background:linear-gradient(180deg,rgba(255,255,255,0.02),var(--panel));border-radius:12px;padding:10px 12px;box-shadow:0 8px 30px rgba(0,0,0,0.6);display:flex;flex-direction:column;gap:6px}
    .card .head{display:flex;align-items:center;justify-content:space-between;gap:8px}
    .card .title{font-weight:800;font-size:14px}
    .card .desc{font-size:12px;color:var(--muted);margin-top:0}
    .brief{font-size:13px;color:var(--muted)}
    .toggle{display:flex;align-items:center;gap:8px;cursor:pointer;padding:4px 0;}
    .chev{transform:rotate(0deg);transition:transform .18s;color:var(--muted)}
    .expanded .chev{transform:rotate(-90deg);color:white}
    .details{overflow:hidden;max-height:0;transition:max-height .35s ease-out;padding-top:0;}
    .expanded .details{max-height:1000px;
    /* max-height ×”×•× ×¨×§ ××•××“×Ÿ ×’×¡, ×œ×©×™×¤×•×¨ ×‘×™×¦×•×¢×™× */
    padding-top:8px}
    .row{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .badge{font-size:12px;padding:6px 8px;border-radius:8px;font-weight:700;min-width:60px;text-align:center}
    .badge.good{background:rgba(57,181,74,0.12);color:var(--good)}
    .badge.warn{background:rgba(255,165,0,0.12);color:var(--warn)}
    .badge.bad{background:rgba(211,59,59,0.12);color:var(--bad)}
    .badge.neutral{background:rgba(255,255,255,0.02);color:var(--muted)}
    .list{display:flex;flex-direction:column;gap:6px;border-top:1px solid rgba(255,255,255,0.05);padding-top:8px;margin-top:4px;}
    .line{display:flex;justify-content:space-between;gap:8px;font-size:13px}
    .line > div:first-child{color:var(--muted); min-width: 120px;}
    .muted{color:var(--muted);font-size:12px}
    .recommend{display:flex;flex-direction:column;gap:6px;margin-top:6px;font-size:12px;}
    footer{margin-top:18px;font-size:12px;color:var(--muted);text-align:center}

    /* contact area compact */
    .contact .email-text{font-size:13px;color:var(--muted)}
    .muted-small{font-size:12px;color:var(--muted)}

    /* Canvas for fingerprint */
    #canvasTest { display: none; }
  </style>
</head>
<body>
  <div class="app" role="application" aria-label="CyberScan Pro Privacy Checker">
    <header>
      <div class="brand">
        <div class="logo">CSP</div>
        <div>
          <h1>CyberScan Pro</h1>
          <p>×‘×“×™×§×•×ª ×¤×¨×˜×™×•×ª ×•×× ×•× ×™××™×•×ª ××œ××•×ª â€” **×›×œ ×ª×•×¦××•×ª ×”×¡×¨×™×§×” ××•×¦×’×•×ª ×›××Ÿ**</p>
        </div>
      </div>

      <div class="controls">
        <div class="score">
          <div class="val" id="privacyScore" style="color:var(--muted) unset;">â€”</div>
          <div class="muted-small">×¦×™×•×Ÿ ×¤×¨×˜×™×•×ª</div>
        </div>
        <button id="quickBtn" class="btn">ğŸ” ×‘×“×™×§×” ××”×™×¨×”</button>
        <button id="fullBtn" class="btn secondary">×‘×“×™×§×” ××§×™×¤×”</button>
      </div>
    </header>

    <div class="results" id="results">
      <div class="card" id="statusCard">
        <div class="head">
          <div>
            <div class="title">××¦×‘ ×¡×§×™×¨×”</div>
            <div class="desc">×œ×—×¥ ×¢×œ "×‘×“×™×§×” ××§×™×¤×”" â€” **×›×œ ×”×ª×•×¦××•×ª × ×©××¨×•×ª ×‘×¦×“ ×”×œ×§×•×— (Client-Side)**.</div>
          </div>
          <div class="brief" id="statusBrief">××•×›×Ÿ ×œ×§×œ×™×˜×”</div>
        </div>
      </div>

      <!-- 1) IP & DNS checks -->
      <div class="card section" id="networkCard">
        <div class="head toggle" data-target="networkCard">
          <div>
            <div class="title">×›×ª×•×‘×ª IP, WebRTC ×•-DNS</div>
            <div class="desc muted">×‘×“×™×§×” ××§×™×¤×” ×œ×“×œ×™×¤×•×ª ×¨×©×ª ×§×¨×™×˜×™×•×ª (IP, DNS)</div>
          </div>
          <div class="row">
            <div class="badge neutral" id="networkBadge">×œ× × ×‘×“×§</div>
            <div class="chev">â€º</div>
          </div>
        </div>
        <div class="details">
          <div class="list" id="publicIpList"></div>
          <div class="list" id="webrtcList"></div>
          <div class="list" id="dnsList"></div>
          <div class="recommend" id="networkRec"></div>
        </div>
      </div>
      
      <!-- 2) Advanced Fingerprinting -->
      <div class="card section" id="fingerprintCard">
        <div class="head toggle" data-target="fingerprintCard">
          <div>
            <div class="title">Web Fingerprinting ××ª×§×“×</div>
            <div class="desc muted">××“×™×“×ª ×™×™×—×•×“×™×•×ª ×”×”×ª×§×Ÿ (Canvas, WebGL, Fonts)</div>
          </div>
          <div class="row">
            <div class="badge neutral" id="fingerprintBadge">×œ× × ×‘×“×§</div>
            <div class="chev">â€º</div>
          </div>
        </div>
        <div class="details">
          <div class="list" id="generalFpList"></div>
          <div class="list" id="canvasFpList"></div>
          <div class="list" id="webglFpList"></div>
          <div class="recommend" id="fingerprintRec"></div>
        </div>
      </div>

      <!-- 3) Storage & Tracking -->
      <div class="card section" id="cookiesCard">
        <div class="head toggle" data-target="cookiesCard">
          <div>
            <div class="title">××—×¡×•×Ÿ ××§×•××™ ×•×¢×§×™×‘×•×ª (Tracking)</div>
            <div class="desc muted">×¢×•×’×™×•×ª (Cookies), LocalStorage, SessionStorage</div>
          </div>
          <div class="row">
            <div class="badge neutral" id="cookiesBadge">×œ× × ×‘×“×§</div>
            <div class="chev">â€º</div>
          </div>
        </div>
        <div class="details">
          <div class="list" id="cookiesList"></div>
          <div class="list" id="storageList"></div>
          <div class="recommend" id="cookiesRec"></div>
        </div>
      </div>
      
      <!-- 4) Browser & System Details -->
      <div class="card section" id="browserCard">
        <div class="head toggle" data-target="browserCard">
          <div>
            <div class="title">×“×¤×“×¤×Ÿ, ××¢×¨×›×ª ×”×¤×¢×œ×” ×•×‘×™×¦×•×¢×™×</div>
            <div class="desc muted">UserAgent, ×©×¤×•×ª, ×¨×›×™×‘×™ ×—×•××¨×” ×•×‘×™×¦×•×¢×™×</div>
          </div>
          <div class="row">
            <div class="badge neutral" id="browserBadge">×œ× × ×‘×“×§</div>
            <div class="chev">â€º</div>
          </div>
        </div>
        <div class="details">
          <div class="list" id="browserList"></div>
          <div class="list" id="hardwareList"></div>
          <div class="list" id="timingList"></div>
          <div class="recommend" id="browserRec"></div>
        </div>
      </div>

      <!-- 5) Network Ports & Connectivity -->
      <div class="card section" id="portsCard">
        <div class="head toggle" data-target="portsCard">
          <div>
            <div class="title">×¡×§×™×¨×ª ×¤×•×¨×˜×™× ××§×•××™×ª (Port Scanning)</div>
            <div class="desc muted">× ×™×¡×™×•× ×•×ª ×’×™×©×” ×‘×˜×•×—×™× ×œ×¤×•×¨×˜×™× ××§×•××™×™× (127.0.0.1)</div>
          </div>
          <div class="row">
            <div class="badge neutral" id="portsBadge">×œ× × ×‘×“×§</div>
            <div class="chev">â€º</div>
          </div>
        </div>
        <div class="details">
          <div class="list" id="portsList"></div>
          <div class="recommend" id="portsRec"></div>
        </div>
      </div>
      
      <!-- 6) Security Headers & TLS -->
      <div class="card section" id="tlsCard">
        <div class="head toggle" data-target="tlsCard">
          <div>
            <div class="title">××‘×˜×—×ª ×—×™×‘×•×¨ (TLS / HTTPS)</div>
            <div class="desc muted">×‘×“×™×§×•×ª ×‘×¡×™×¡×™×•×ª ×œ×’×‘×™ ×× ×’× ×•× ×™ ×”×¦×¤× ×” ×•×¤×¨×•×˜×•×§×•×œ</div>
          </div>
          <div class="row">
            <div class="badge neutral" id="tlsBadge">×œ× × ×‘×“×§</div>
            <div class="chev">â€º</div>
          </div>
        </div>
        <div class="details">
          <div class="list" id="tlsList"></div>
          <div class="recommend" id="tlsRec"></div>
        </div>
      </div>

      <!-- Contact area -->
       <div class="card" id="contactCard">
        <div class="head" style="align-items:center;">
          <div>
            <div class="title">×™×¦×™×¨×ª ×§×©×¨ ×¢× ×”××¤×ª×—×™×</div>
            <div class="desc muted">×”×•×“×¢×•×ª ×™×•×¤× ×• ×œ×›×ª×•×‘×ª ×”××™×™×œ ×”××•×¡×•×•×™×ª ×©×œ ×”××¤×ª×—.</div>
          </div>
          <div class="row">
            <div class="contact">
              <div class="icon" id="mailIcon" title="×©×œ×— ××™××™×™×œ">âœ‰ï¸</div>
              <div class="email-text" id="emailText">hacker[dot]david[at]gmail[dot]com</div>
            </div>
          </div>
        </div>
        <div class="details" style="max-height:400px;padding-top:6px;">
          <!-- ×˜×•×¤×¡ ×™×¦×™×¨×ª ×§×©×¨ × ×©××¨ ×›-fallback, ××ª×•×š ××˜×¨×” ×œ××¤×©×¨ ×™×¦×™×¨×ª ×§×©×¨ -->
          <form id="contactForm" class="contact-form" onsubmit="return handleContactSubmit(event)">
            <input id="cf_name" placeholder="×©×" required />
            <input id="cf_subject" placeholder="× ×•×©×" required />
            <textarea id="cf_message" placeholder="×”×•×“×¢×”" rows="4" required></textarea>
            <div style="display:flex;justify-content:space-between;align-items:center;gap:8px">
              <div class="muted-small">×”×•×“×¢×” ×ª×¢×‘×•×¨ ×œ×ª×•×›× ×ª ×“×•××¨ ××œ×§×˜×¨×•× ×™ ××§×•××™×ª â€” **×œ× × ×©×œ×—×ª ×™×©×™×¨×•×ª ×œ×©×¨×ª ×¡×•×“×™**.</div>
              <button class="btn" type="submit">×©×œ×— ×“×¨×š ×ª×•×›× ×ª ×“×•××¨</button>
            </div>
          </form>
        </div>
      </div>


      <!-- ×¨×›×™×‘ × ×¡×ª×¨ ×œ-Canvas Fingerprinting -->
      <canvas id="canvasTest" width="300" height="30"></canvas>

    </div>

    <!-- ×”×•×“×¢×ª ×©×§×™×¤×•×ª ×§×¨×™×˜×™×ª -->
    <footer>
      <p>âš ï¸ **×”×¦×”×¨×ª ×©×§×™×¤×•×ª:** ××™×Ÿ ×©×™××•×© ×‘×©×¨×ª×™× ×—×™×¦×•× ×™×™× ×œ××™×¡×•×£ × ×ª×•× ×™×. ×›×œ ×”×‘×“×™×§×•×ª ×”×œ×œ×• (×›×•×œ×œ ×”-IP ×•-WebRTC) ××ª×‘×¦×¢×•×ª ×¢×œ ×™×“×™ ×”×“×¤×“×¤×Ÿ ×©×œ×›× ×‘×œ×‘×“ ×•××™×•×¢×“×•×ª ××š ×•×¨×§ ×œ×”×¦×’×ª ×”××™×“×¢ **×œ×›×** ×¢×œ ×”××¡×š. ×”× ×ª×•× ×™× ×œ× × ×©××¨×™×, ××©×•×“×¨×™× ××• ××•×’×“×¨×™× ×‘×¦×“ ×”×©×¨×ª. Â© CyberScan Pro â€” ×¤×•×ª×— ×¢×œ ×™×“×™ ××•××—×™ ××‘×˜×—×ª ××™×“×¢ ×××•×©×¨×™×.</p>
    </footer>
  </div>

  <script>
    // === ×ª×¦×•×¨×” ×›×œ×œ×™×ª ×•×§×‘×•×¢×™× ××§×¦×•×¢×™×™× ===
    const CONFIG = {
        // ×”××™×™×œ ××•×¦×¤×Ÿ ×œ×× ×™×¢×ª ××™×¡×•×£ ××•×˜×•××˜×™. ×¨×§ ×”×’×¨×¡×” ×”××•×¦×¤× ×ª × ×©××¨×ª ×‘×§×•×“ ×”××§×•×¨.
        // ×–×•×”×™ ×’×¨×¡×” ×‘×˜×•×—×” ×™×•×ª×¨ ××‘×—×™× ×ª ××‘×˜×—×ª ××™×“×¢ ××™×©×™ ×©×œ ×”××¤×¢×™×œ×™×.
        CONTACT_EMAIL_OBFUSCATED: "Hacker[dot]david[at]gmail[dot]com",
        // ×¨×©×™××ª ×¤×•×¨×˜×™× ××§×•××™×™× ×œ×‘×“×™×§×” ×‘×˜×™×—×•×ª×™×ª (×œ× ×—×•×“×¨× ×™×ª)
        COMMON_LOCAL_PORTS: [21, 22, 23, 80, 443, 8080, 8443, 3000],
        IP_CHECK_API: 'https://api.ipify.org?format=json',
        DNS_TRACE_API: 'https://cloudflare.com/cdn-cgi/trace',
    };

    // ×¤×•× ×§×¦×™×™×ª ×¢×–×¨ ×›×œ×œ×™×ª ×œ×‘×—×™×¨×ª ××œ×× ×˜×™×
    const $ = id => document.getElementById(id);
    
    // ×”×’×“×¨×” ××•×˜×•××˜×™×ª ×©×œ ×§×™×¤×•×œ / ×¤×ª×™×—×”
    document.querySelectorAll('.toggle').forEach(t=>{
      t.addEventListener('click', ()=>{
        const parent = t.closest('.section');
        parent.classList.toggle('expanded');
      });
    });
    
    // === ×¤×•× ×§×¦×™×•×ª ×œ×™×¦×™×¨×ª ×§×©×¨ (Contact) â€“ ×©××™×¨×” ×¢×œ ×¡×•×“×™×•×ª ×”××™×™×œ ===

    /**
     * ×¤×•× ×§×¦×™×” ×œ×‘× ×™×™×ª ×”××™×™×œ ×”××œ× ××ª×•×š ×”××—×¨×•×–×ª ×”××•×¦×¤× ×ª (×¤×™×¢× ×•×— ××§×•××™).
     * @param {string} obfuscatedEmail ×”×›×ª×•×‘×ª ×”××•×¡×•×•×™×ª.
     * @returns {string} ×›×ª×•×‘×ª ×”××™×™×œ ×”××œ××” ×•×”××¤×•×¢× ×—×ª.
     */
    function resolveEmail(obfuscatedEmail) {
        return obfuscatedEmail.replace(/\[dot\]/g, '.').replace(/\[at\]/g, '@');
    }
    
    /**
     * ×¤×•× ×§×¦×™×” ×œ×‘× ×™×™×ª ×§×™×©×•×¨ MailTo.
     */
    function buildMailTo(email, subject, body){
      return `mailto:${encodeURIComponent(email)}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
    }

    // ×˜×™×¤×•×œ ×‘×œ×—×™×¦×” ×¢×œ ××™×™×§×•×Ÿ ×”××™×™×œ
    $('mailIcon').addEventListener('click', ()=>{
      try {
        const realEmail = resolveEmail(CONFIG.CONTACT_EMAIL_OBFUSCATED);
        const mailto = buildMailTo(realEmail, "×¤× ×™×” ×-CyberScan Pro (×‘×“×™×§×” ×›×œ×œ×™×ª)", "×©×œ×•×,\n\n");
        window.location.href = mailto;
      } catch (e) {
        alert("×©×’×™××” ×‘×¤×ª×™×—×ª ×ª×•×›× ×ª ×“×•××¨: " + e.message);
      }
    });

    // ×˜×™×¤×•×œ ×‘×©×œ×™×—×ª ×”×˜×•×¤×¡ ×œ×™×¦×™×¨×ª ×§×©×¨
    function handleContactSubmit(e){
      e.preventDefault();
      try {
        const realEmail = resolveEmail(CONFIG.CONTACT_EMAIL_OBFUSCATED);
        const name = $('cf_name').value.trim() || '×× ×•× ×™××™';
        const subj = $('cf_subject').value.trim();
        const msg = $('cf_message').value.trim();
        const body = `×©× ×”×©×•×œ×—: ${name}\n\n×ª×•×›×Ÿ ×”×”×•×“×¢×”:\n${msg}\n\n---\n× ×©×œ×— ×-CyberScan Pro (Client-Side)`;
        const mailto = buildMailTo(realEmail, subj || "×¤× ×™×” ×›×œ×œ×™×ª ×œ-CyberScan Pro", body);
        window.location.href = mailto;
      } catch (e) {
        alert("×©×’×™××” ×‘×™×¦×™×¨×ª ×§×™×©×•×¨ MailTo: " + e.message);
      }
      return false;
    }

    // === ×¤×•× ×§×¦×™×•×ª ×¢×–×¨ ×œ-UI ×•××‘×˜×—×” ===
    
    /**
     * ×”×’×“×¨×ª ×›×•×ª×¨×ª ×”×¡×˜×˜×•×¡ (Badge) ×‘×›×¨×˜×™×¡ ×¡×¤×¦×™×¤×™.
     */
    function setBadge(id, text, cls){
      const el = $(id);
      if(!el) return;
      el.className = `badge ${cls || 'neutral'}`;
      el.textContent = text;
    }

    /**
     * **×ª×™×§×•×Ÿ ××‘×˜×—×” ×§×¨×™×˜×™ ×××•××—×”:**
     * ×”×•×¡×¤×ª ×¤×¨×™×˜ ××™×“×¢ ×œ×¨×©×™××” ×‘××•×¤×Ÿ ×××•×‘×˜×— (×× ×™×¢×ª XSS ×¢×œ ×™×“×™ ×©×™××•×© ×‘-textContent).
     * @param {string} id ID ×©×œ ××œ×× ×˜ ×”-list (×”-div ×©××›×™×œ ××ª ×”×ª×•×¦××•×ª).
     * @param {string} key ××¤×ª×— (×ª×™××•×¨) ×œ×ª×•×¦××”.
     * @param {string|number} value ×”×¢×¨×š ×©×œ ×”×ª×•×¦××”.
     */
    function appendList(id, key, value, isBold=false){
      const el = $(id);
      if(!el) return;

      const line = document.createElement('div');
      line.className = 'line';

      const keyDiv = document.createElement('div');
      keyDiv.textContent = key;
      line.appendChild(keyDiv);

      const valueDiv = document.createElement('div');
      const textNode = document.createElement(isBold ? 'strong' : 'span');
      // ×©×™××•×© ×‘-textContent ××‘×˜×™×— ×©×›×œ ×ª×•×›×Ÿ HTML ×‘×ª×•×š 'value' ×™×•×¦×’ ×›×˜×§×¡×˜ ×’×œ×•×™ ×•×œ× ×™×‘×•×¦×¢ ×›×§×•×“.
      textNode.textContent = String(value);
      valueDiv.appendChild(textNode);
      
      line.appendChild(valueDiv);
      el.appendChild(line);
    }
    
    /**
     * ××™×¤×•×¡ ×›×œ ×›×¨×˜×™×¡×™ ×”×ª×•×¦××•×ª.
     */
    function clearAll(){
      const sections = ['publicIpList','webrtcList','dnsList','generalFpList','canvasFpList','webglFpList','cookiesList','storageList','browserList','hardwareList','timingList','portsList','tlsList'];
      sections.forEach(id=>{ const el=$(id); if(el) el.innerHTML='';});
      
      const badges = ['networkBadge', 'fingerprintBadge', 'cookiesBadge', 'browserBadge', 'portsBadge', 'tlsBadge'];
      badges.forEach(b=>setBadge(b,'×œ× × ×‘×“×§','neutral'));
      
      $('privacyScore').textContent = 'â€”';
      $('statusBrief').textContent = '××•×›×Ÿ ×œ×§×œ×™×˜×”';
    }

    // === ×× ×’× ×•×Ÿ WebRTC ×œ×›×™×“×ª IP ××§×•××™ ===

    /**
     * ××ª×•×“×” ××•××—×™×ª ×œ××™×¡×•×£ ×›×ª×•×‘×•×ª ICE. ×–×•×”×™ ×‘×“×™×§×” ××”×¡×•×’ ×©××™× ×• × ×¤×’×¢ ×¢"×™ ×—×¡×™××ª CORS.
     * @param {number} timeout ×–××Ÿ ××§×¡×™××œ×™ ×œ×”××ª×™×Ÿ ×œ×¤× ×™ ×¡×’×™×¨×ª ×”×—×™×‘×•×¨.
     * @returns {Promise<Array<{ip: string, type: string}>>} ××¢×¨×š ×©×œ ×›×ª×•×‘×•×ª IP ×•×¡×•×’×Ÿ.
     */
    function gatherICE(timeout=3000){
      return new Promise((resolve)=>{
        // ×©×™××•×© ×‘××¤×” ×œ×× ×™×¢×ª ×›×¤×™×œ×•×™×•×ª IP
        const ips = new Map();
        let pc;
        try{
          // ×¡×˜ ×©×¨×ª×™ STUN ×¦×™×‘×•×¨×™ ×¡×˜× ×“×¨×˜×™
          pc = new RTCPeerConnection({iceServers:[{urls:['stun:stun.l.google.com:19302', 'stun:stun1.l.google.com:19302', 'stun:stun.nextcloud.com:443']}]});
          pc.createDataChannel('d');
          
          pc.onicecandidate = e=>{
            if(!e.candidate) return;
            const cand = e.candidate.candidate;
            const parts = cand.split(' ');
            
            // ×”××™××“ ×”×—××™×©×™ ×‘××¢×¨×š ×”×•× ×›×ª×•×‘×ª ×”-IP
            const ipCandidate = parts[4]; 
            // ×”××™××“ ×”×©××™× ×™ ×”×•× ×¡×•×’ ×”××•×¢××“ (host, srflx, relay)
            const typeCandidate = parts[7]; 
            
            if (ipCandidate && (ipCandidate.includes('.') || ipCandidate.includes(':'))) {
                 // ×¡×™× ×•×Ÿ IP ×¤×¨×˜×™×™× ×™×“×•×¢×™× ×©× ×—×©×¤×™× ×“×¨×š ×—×™×‘×•×¨ ×”-host
                const isPrivate = ipCandidate.startsWith('10.') || ipCandidate.startsWith('172.') || ipCandidate.startsWith('192.168.') || ipCandidate.startsWith('fc00:');

                let type = '××—×¨';
                if (typeCandidate === 'srflx') type = `×¦×™×‘×•×¨×™ (STUN) - ${isPrivate ? '×—×©×•×“' : '×’×œ×•×™'}`;
                else if (typeCandidate === 'host') type = isPrivate ? '××§×•××™ (×¤×¨×˜×™)' : '××§×•××™ (Host)';
                else if (typeCandidate === 'relay') type = '×××¡×¨ (TURN)';

                ips.set(ipCandidate, {ip: ipCandidate, type: type});
            }
          };
          
          pc.onicegatheringstatechange = () => {
              if (pc.iceGatheringState === 'complete') {
                  // ×× ×”××™×¡×•×£ ×”×•×©×œ×, × ×™×ª×Ÿ ×œ×¡×’×•×¨
                  try { pc.close(); } catch (e) { /* noop */ }
                  resolve(Array.from(ips.values()));
              }
          };

          pc.createOffer({offerToReceiveVideo: false, offerToReceiveAudio: false}).then(offer=>{
              return pc.setLocalDescription(offer);
          }).catch(err => {
              // ×©×’×™××” (×œ×¨×•×‘ ×—×•×¡×¨ ×”×¨×©××•×ª ××• ×—×¡×™××ª ×¤×¨×˜×™×•×ª ×‘×“×¤×“×¤×Ÿ)
              try { pc.close(); } catch (e) { /* noop */ }
              resolve([]);
          });
          
          // ×¤×¡×§ ×–××Ÿ ×‘×˜×™×—×•×ª×™
          setTimeout(()=>{ try{ pc.close(); }catch(e){}; resolve(Array.from(ips.values())); }, timeout);

        }catch(err){ 
            if(pc && pc.close) pc.close();
            resolve([]); 
        }
      });
    }

    // === ×¤×•× ×§×¦×™×•×ª ××ª×§×“××•×ª ×œ-Fingerprinting ===
    
    /**
     * ×™×¦×™×¨×ª Hash ×§× ×‘×¡ ×™×™×—×•×“×™×ª
     * @returns {string} Hash ×™×™×—×•×“×™×ª ××• ×”×•×“×¢×ª ×©×’×™××”.
     */
    function getCanvasFingerprint() {
        if (!window.WebGLRenderingContext) {
            return '×œ× × ×ª××š (WebGL ×—×¡×¨)';
        }
        try {
            const canvas = $('canvasTest');
            const ctx = canvas.getContext('2d');
            
            // ×™×¦×™×¨×ª ×˜×§×¡×˜ ×˜×™×¤×•×¡×™
            ctx.textBaseline = "top";
            ctx.font = '14px Arial (Canvas FP)';
            ctx.textStyle = '#f60';
            ctx.fillText("CyberScan Pro WebFP Test: 1.0 (Text)", 2, 2);
            
            // ×™×¦×™×¨×ª ××œ×‘×Ÿ ×’×¨×¤×™ ×§×˜×Ÿ
            ctx.fillStyle = '#0f0';
            ctx.fillRect(10, 10, 20, 20);
            
            // ×¢×™×‘×•×“ ×ª××•× ×” ×œ×¤×™×§×¡×œ×™× (×‘×“×™×§×ª Alias)
            const hash = btoa(ctx.getImageData(0, 0, canvas.width, canvas.height).data.toString()).substring(0, 32);

            return hash;
        } catch (e) {
            return `×©×’×™××” (Error: ${e.message.substring(0, 30)})`;
        }
    }
    
    /**
     * ××™×¡×•×£ ××™×“×¢ ×-WebGL (×™×›×•×œ ×œ×”×™×•×ª ×™×™×—×•×“×™)
     * @returns {Object} ×¤×¨×˜×™ WebGL.
     */
    function getWebGlInfo() {
        const info = {};
        const canvas = document.createElement('canvas');
        let gl;
        try {
            gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
            if (gl) {
                const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                info['Renderer'] = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) || 'N/A';
                info['Vendor'] = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL) || 'N/A';
                info['Version'] = gl.getParameter(gl.VERSION) || 'N/A';
            } else {
                info['Renderer'] = '×œ× × ×ª××š/×—×¡×•×';
            }
        } catch (e) {
            info['Renderer'] = `×©×’×™××” (${e.message.substring(0, 30)})`;
        }
        return info;
    }

    // === ×× ×’× ×•×Ÿ ×¡×¨×™×§×ª ×¤×•×¨×˜×™× ××§×•××™×ª (Safe Port Scan) ===

    /**
     * ×¡×§×™×¨×ª ×¤×•×¨×˜×™× ××§×•××™×ª ×‘×××¦×¢×•×ª fetch ×¢× no-cors.
     * ×©×™×˜×” ×‘×˜×•×—×” ×•×œ× ×—×•×“×¨× ×™×ª ×”× ×ª×•× ×” ×œ××’×‘×œ×•×ª ×“×¤×“×¤×Ÿ (Same-Origin / PNA).
     * @param {Array<number>} ports ×¨×©×™××ª ×¤×•×¨×˜×™× ×œ×‘×“×™×§×”.
     * @returns {Promise<Array<{port: number, open: boolean}>>}
     */
    async function safePortScan(ports) {
        const results = [];
        await Promise.all(ports.map(async p => {
            const url = `http://127.0.0.1:${p}/`;
            const start = performance.now();
            
            // ×©×™××•×© ×‘×¤×•× ×§×¦×™×” ××•×’×‘×œ×ª ×‘×–××Ÿ (Timeout)
            const fetchPromise = fetch(url, { method: 'GET', mode: 'no-cors', cache: 'no-store', redirect: 'error' });
            
            // ×¤×¡×§ ×–××Ÿ ×‘×˜×™×—×•×ª×™ ×•××”×™×¨ ×œ×›×œ ×‘×§×©×”
            const timeoutPromise = new Promise(resolve => setTimeout(() => resolve({ error: 'Timeout' }), 400));
            
            const result = await Promise.race([fetchPromise, timeoutPromise]);
            const end = performance.now();
            
            // × ×™×ª×•×— ×ª×•×¦××”:
            // ×× ×§×™×‘×œ× ×• ×ª×’×•×‘×” (××¤×™×œ×• ×ª×’×•×‘×ª ×©×’×™××” ×©×œ ×”×“×¤×“×¤×Ÿ) ×•××™×Ÿ ×©×’×™××ª CORS, ×–×” ×¡×™××Ÿ ×œ"×”×©×’×”" (Reached).
            // ×”×“×¨×š ×”×™×—×™×“×” ×œ×”×‘×—×™×Ÿ ×× ×¤×•×¨×˜ '×¤×ª×•×—' ××¤×•×¨×˜ '×¡×’×•×¨/××¡×•× ×Ÿ' ×”×™× ×œ×¤×™ ×”×–×× ×™×.
            // ×× ×”×¤×•×¨×˜ ×œ× ××•×©×’ (timed out/××¤×™×œ×• ×œ× ×”×¦×œ×™×— ×œ×©×œ×•×—) ×”×”××¦×” × ×›×©×œ×”.
            
            let isReached = result && !result.error && (end - start) < 400; // ×‘×¡×™×¡×™×ª: ×× ×”×¦×œ×—× ×• ×œ×”×©×™×’ ×ª×’×•×‘×” ××”×™×¨×”
            
            results.push({ port: p, open: isReached });
        }));
        return results;
    }

    // === ×¤×•× ×§×¦×™×™×ª ×”×¡×¨×™×§×” ×”×¨××©×™×ª ===

    /**
     * ××¤×¢×™×œ ××ª ×›×œ ×”×‘×“×™×§×•×ª ×”× ×“×¨×©×•×ª ×•××¢×“×›×Ÿ ××ª ×”×××©×§.
     */
    async function runScan({extended=false}){
      clearAll();
      $('statusBrief').textContent = '××‘×¦×¢ ×¡×¨×™×§×” (×”××ª×Ÿ ×‘×¡×‘×œ× ×•×ª)...';
      let score = 100;
      
      // ==========================================================
      // 1. ×¨×©×ª ×•-IP
      // ==========================================================
      let networkIssues = 0;
      
      // 1.1) IP ×¦×™×‘×•×¨×™
      try{
        const resp = await fetch(CONFIG.IP_CHECK_API);
        if(resp.ok){
          const j = await resp.json();
          appendList('publicIpList', 'IP ×¦×™×‘×•×¨×™', j.ip, true);
        }else throw new Error("API call failed");
      }catch(e){
        appendList('publicIpList', 'IP ×¦×™×‘×•×¨×™', `×œ× ×–××™×Ÿ / × ×—×¡× (Error: ${e.message.substring(0, 30)})`);
        networkIssues += 1;
        score -= 5;
      }
      
      // 1.2) WebRTC/ICE
      try{
        appendList('webrtcList', '--- WebRTC / ×“×œ×™×¤×ª IP ×¤×¨×˜×™ ---', '', false);
        const ips = await gatherICE(extended ? 5000 : 3000);
        if(ips.length===0){
          appendList('webrtcList', '××•×¢××“×™× ××§×•××™×™×', '×œ× × ××¦××• (×‘×¨×›×”: ×¨×•×‘ ×”×¡×™×›×•×™×™× ×œ×—×¡×™××”)', true);
          networkIssues += 0;
        } else {
          let hasLocal = false;
          ips.forEach(it=>{
            const key = it.type;
            const isCritical = key.includes('×¤×¨×˜×™') || key.includes('Host');
            appendList('webrtcList', key, it.ip, isCritical);
            if(isCritical) hasLocal = true;
          });
          if(hasLocal) {
            networkIssues += 2;
            score -= 25;
          }
        }
      }catch(e){ appendList('webrtcList', '×©×’×™××ª ICE', String(e).slice(0, 50)); networkIssues += 0.5; score -= 10; }
       
      // 1.3) DNS (×‘×“×™×§×” ×—×œ×§×™×ª)
      try{
        appendList('dnsList', '--- ×‘×“×™×§×ª DNS (Cloudflare) ---', '', false);
        const r = await fetch(CONFIG.DNS_TRACE_API);
        if(r.ok){
          const text = await r.text();
          const resolver = text.split('\n').find(l=>l.startsWith('resolver='));
          const dnsValue = resolver ? resolver.split('=')[1] : '×œ× × ××¦× ××™×“×¢';
          
          appendList('dnsList', '×›×ª×•×‘×ª DNS (××ª×•×š CF)', dnsValue, true);
          if (dnsValue === '1.1.1.1' || dnsValue === '8.8.8.8') {
             appendList('dnsList', '×”×¢×¨×ª ×ª×•×¦××”', '×©×¨×ª ×”-DNS ×’×œ×•×™ ×•××–×•×”×” (×™×™×ª×›×Ÿ ×©××™× ×• ISP)', false);
          } else if (dnsValue !== '×œ× × ××¦× ××™×“×¢' && dnsValue.includes('.')) {
              appendList('dnsList', '×”×¢×¨×ª ×ª×•×¦××”', '× ×¨××” ×©××–×”×” ×¡×¤×§×™×ª ×©×™×¨×•×ª ××™× ×˜×¨× ×˜ ×’×œ×•×™', false);
              score -= 8;
          }
        } else throw new Error("CF not reachable");
      }catch(e){ appendList('dnsList', '×“×œ×™×¤×ª DNS', '×‘×“×™×§×” × ×›×©×œ×” / × ×—×¡××”', false); }
      
      // ×¡×˜××˜×•×¡ ×¨×©×ª
      let networkStatus = networkIssues === 0 ? 'good' : (networkIssues > 1 ? 'bad' : 'warn');
      let networkText = networkIssues === 0 ? '× ×§×™' : (networkIssues > 1 ? '×¡×™×›×•×Ÿ ×’×œ×•×™' : '××–×”×¨×” ×§×œ×”');
      setBadge('networkBadge', networkText, networkStatus);

      // ==========================================================
      // 2. Web Fingerprinting
      // ==========================================================
      let fpIssues = 0;
      
      // 2.1) ×˜×‘×™×¢×ª ××¦×‘×¢ ×‘×¡×™×¡×™×ª
      appendList('generalFpList', '--- ×˜×‘×™×¢×ª ××¦×‘×¢ ×›×œ×œ×™×ª ---', '', false);
      const fp = {
          'User Agent String': navigator.userAgent || '×—×¡×¨',
          '×©×¤×•×ª (Languages)': (navigator.languages || []).join(',') || navigator.language || '×—×¡×¨',
          '×¨×–×•×œ×•×¦×™×™×ª ×”××¡×š': `${screen.width}x${screen.height}x${screen.colorDepth}bit`,
          '×–×™×›×¨×•×Ÿ ×”×ª×§×Ÿ': `${navigator.deviceMemory || '× ×—×¡×'}GB`,
          '××¢×‘×“×™× ×œ×•×’×™×™×': navigator.hardwareConcurrency || '× ×—×¡×',
      };
      Object.entries(fp).forEach(([k,v])=>appendList('generalFpList', k, v, k.includes('Agent')));
      
      if(fp['User Agent String'] === navigator.userAgent) score -= 5;
      if(fp['××¢×‘×“×™× ×œ×•×’×™×™×'] !== '× ×—×¡×') score -= 3;
      
      // 2.2) Canvas Fingerprint
      if(extended){
        appendList('canvasFpList', '--- ×˜×‘×™×¢×ª ××¦×‘×¢ (Canvas) ---', '', false);
        const canvasHash = getCanvasFingerprint();
        appendList('canvasFpList', 'Canvas Hash', canvasHash, true);
        if(!canvasHash.includes('×©×’×™××”') && !canvasHash.includes('×—×¡×¨')){ score -= 15; fpIssues += 1; }
      }
      
      // 2.3) WebGL Fingerprint
      if(extended){
        appendList('webglFpList', '--- ×˜×‘×™×¢×ª ××¦×‘×¢ (WebGL) ---', '', false);
        const webglInfo = getWebGlInfo();
        Object.entries(webglInfo).forEach(([k,v])=>appendList('webglFpList', k, v, k.includes('Renderer')));
        if(webglInfo.Renderer && webglInfo.Renderer !== '×œ× × ×ª××š/×—×¡×•×') { score -= 10; fpIssues += 1; }
      }
      
      // ×¡×˜××˜×•×¡ Fingerprinting
      let fpStatus = fpIssues === 0 ? 'good' : (fpIssues > 1 ? 'bad' : 'warn');
      let fpText = fpIssues === 0 ? '×‘×¡×™×¡×™ ×‘×œ×‘×“' : (fpIssues > 1 ? '×™×™×—×•×“×™ ×××•×“' : '×™×™×—×•×“×™');
      setBadge('fingerprintBadge', fpText, fpStatus);
      
      // ==========================================================
      // 3. ××—×¡×•×Ÿ ××§×•××™ ×•×¢×§×™×‘×•×ª
      // ==========================================================
      let cookieIssues = 0;
      
      // 3.1) Cookies
      appendList('cookiesList', '--- ×¢×•×’×™×•×ª HTTP (Cookies) ---', '', false);
      try{
        const cookieStr = document.cookie || '';
        const keys = cookieStr.split(';').map(s=>s.trim()).filter(Boolean);
        appendList('cookiesList', '×¡×”"×› ×¢×•×’×™×•×ª ×œ××ª×¨ ×–×”', keys.length, true);
        if(keys.length > 0) {
            cookieIssues += 1;
            keys.slice(0, 3).forEach(c => appendList('cookiesList', '×¢×•×’×™×™×” ×“×•×’××”', c.split('=')[0], false));
        }
        if(keys.length > 5) score -= 6;
      }catch(e){ /* noop */ }
      
      // 3.2) Web Storage APIs
      appendList('storageList', '--- ××—×¡×•×Ÿ ×‘×“×¤×“×¤×Ÿ (Storage) ---', '', false);
      try{
        appendList('storageList', 'LocalStorage Items', localStorage.length, localStorage.length > 0);
        appendList('storageList', 'SessionStorage Items', sessionStorage.length, sessionStorage.length > 0);
        if(localStorage.length > 10 || sessionStorage.length > 0) score -= 4;
      }catch(e){ 
        appendList('storageList', '××™×¡×•×£ ××—×¡×•×Ÿ', '× ×—×¡× (×™×™×ª×›×Ÿ ×‘×”×’×“×¨×•×ª)', false);
        cookieIssues += 0.5;
      }
      
      // ×¡×˜××˜×•×¡ Cookies
      let cookieStatus = cookieIssues === 0 ? 'good' : 'warn';
      setBadge('cookiesBadge', cookieIssues === 0 ? '× ×§×™ ×™×—×¡×™×ª' : '×¢×§×™×‘×•×ª ×§×™×™××ª', cookieStatus);

      
      // ==========================================================
      // 4. ×¤×¨×˜×™ ×“×¤×“×¤×Ÿ ×•××¢×¨×›×ª
      // ==========================================================
      
      // 4.1) ×¤×¨×˜×™ ×“×¤×“×¤×Ÿ
      appendList('browserList', '--- ×¤×¨××˜×¨×™× ×‘×¡×™×¡×™×™× ---', '', false);
      try{
        appendList('browserList', '×¤×œ×˜×¤×•×¨××”', navigator.platform || '×œ× ×™×“×•×¢', true);
        appendList('browserList', '××–×•×¨ ×–××Ÿ (Timezone)', Intl.DateTimeFormat().resolvedOptions().timeZone || '×—×¡×¨', false);
        appendList('browserList', '××–×”×” ××¤×¢×™×œ (Vendor)', navigator.vendor || '×—×¡×¨', false);
      }catch(e){ /* noop */ }
      
      // 4.2) ×—×•××¨×”
      appendList('hardwareList', '--- ××™×“×¢ ×—×•××¨×” ---', '', false);
      try{
        if(navigator.getBattery){ 
          const bat = await navigator.getBattery(); 
          appendList('hardwareList', 'Battery Level', `${Math.round(bat.level*100)}%`, bat.level < 0.2);
        } else { 
          appendList('hardwareList', 'Battery API', '×œ× × ×ª××š/×—×¡×•×'); 
        }
        const conn = navigator.connection || null;
        if(conn){
          appendList('hardwareList', 'Network Effective Type', conn.effectiveType||'?', false);
        }
      }catch(e){ /* noop */ }
      
      // 4.3) ×‘×™×¦×•×¢×™×
      appendList('timingList', '--- ×–×× ×™ ×‘×™×¦×•×¢ (Performance) ---', '', false);
      try {
          const perfTiming = performance.getEntriesByType("navigation")[0];
          if (perfTiming) {
              appendList('timingList', '×–××Ÿ ×˜×¢×™× ×” (×“×•××™×™×Ÿ)', `${Math.round(perfTiming.domainLookupEnd - perfTiming.domainLookupStart)}ms`);
              appendList('timingList', '×–××Ÿ ×ª×’×•×‘×” (×©×¨×ª)', `${Math.round(perfTiming.responseEnd - perfTiming.requestStart)}ms`);
          } else {
              appendList('timingList', 'Performance API', '×œ× × ×ª××š');
          }
      } catch (e) { /* noop */ }
      
      setBadge('browserBadge','× ×‘×“×§','neutral');


      // ==========================================================
      // 5. ×¡×§×™×¨×ª ×¤×•×¨×˜×™× (×‘×“×™×§×” ××§×™×¤×” ×™×•×ª×¨)
      // ==========================================================
      let portIssues = 0;
      appendList('portsList', '--- ×¤×•×¨×˜×™× ×œ×¡×§×™×¨×” (127.0.0.1) ---', '', false);
      if(extended){
        try{
            const portResults = await safePortScan(CONFIG.COMMON_LOCAL_PORTS);
            portResults.sort((a,b)=>a.port-b.port).forEach(r=>{
                const isIssue = r.open;
                appendList('portsList', `×¤×•×¨×˜ ${r.port}`, (r.open? '××•×©×’! (Reached)':'×œ× ××•×©×’'), isIssue);
                if(isIssue) portIssues += 1;
            });
            if(portIssues > 0) score -= 15;
            
        }catch(e){ 
            appendList('portsList', '×©×’×™××ª ×¡×¨×™×§×”', `× ×›×©×œ×” (Error: ${e.message.substring(0, 50)})`, true); 
            portIssues = 1; 
        }
      } else {
        appendList('portsList', '××¦×‘', '×‘×“×™×§×” ××§×™×¤×” ××™× ×” ×¤×¢×™×œ×” - ×œ×—×¥ "×‘×“×™×§×” ××§×™×¤×”"', false);
      }
      // Status
      let portStatus = portIssues === 0 ? 'good' : 'bad';
      setBadge('portsBadge', portIssues === 0 ? '× ×§×™' : '×—×©×™×¤×” ××§×•××™×ª', portStatus);
      
      // ==========================================================
      // 6. ××‘×˜×—×ª ×—×™×‘×•×¨
      // ==========================================================
      
      // 6.1) HTTPS
      try{
        appendList('tlsList', '--- ×‘×“×™×§×•×ª SSL/TLS ---', '', false);
        const isHttps = location.protocol === 'https:';
        appendList('tlsList', 'HTTPS ×‘××¢×¨×›×ª', isHttps? '×¤×•×¢×œ ×•×××•×‘×˜×—':'×œ× ×¤×¢×™×œ! ×¡×™×›×•×Ÿ', !isHttps);
        if(!isHttps) score -= 30;
      }catch(e){ /* noop */ }
      
      // 6.2) Mixed Content
      // ×‘×“×™×§×” ×¤×©×•×˜×” ×œ×•×•×“× ×©×× ×—× ×• ×œ× ×‘-HTTPS ×•×™×© HTTP ×‘×§×™×©×•×¨
      try{
          const hasMixedContent = location.protocol === 'https:' && document.querySelector('a[href^="http:"]');
          appendList('tlsList', 'Mixed Content (HTTP ×‘-HTTPS)', hasMixedContent ? '×§×™×©×•×¨×™× ×œ× ×××•×‘×˜×—×™× × ××¦××•' : '×œ× × ××¦×', hasMixedContent);
          if(hasMixedContent) score -= 5;
      }catch(e){ /* noop */ }

      // Status
      let tlsStatus = location.protocol === 'https:' ? 'good' : 'bad';
      setBadge('tlsBadge', location.protocol === 'https:' ? '×××•×‘×˜×—' : '×œ× ×××•×‘×˜×—', tlsStatus);

      // ==========================================================
      // ×¡×™×•×
      // ==========================================================
      
      // ×—×©×•×‘: ×¦×™×•×Ÿ ×’×œ×•×‘×œ×™ (Global Score Calculation)
      if(score < 0) score = 0;
      if(score > 100) score = 100;
      $('privacyScore').textContent = score;

      const scEl = $('privacyScore');
      scEl.style.color = score > 75 ? 'var(--good)' : (score>45 ? 'var(--warn)' : 'var(--bad)');
      $('statusBrief').textContent = `×”×¡×¨×™×§×” ×”×•×©×œ××”. ×¦×™×•×Ÿ ×¡×•×¤×™: ${score}/100`;
      
      // ×”×¨×—×‘ ××•×˜×•××˜×™×ª ×›×¨×˜×™×¡×™× ×‘×¢×œ×™ ×‘×¢×™×•×ª
      document.querySelectorAll('.section').forEach(card => {
        const badge = card.querySelector('.badge');
        if (badge && badge.classList.contains('bad') || badge.classList.contains('warn')) {
          card.classList.add('expanded');
        }
      });
    }


    // === ×”×¨×¦×” ×¨××©×•× ×™×ª ×•×”××–× ×” ×œ×›×¤×ª×•×¨×™× ===

    document.addEventListener('DOMContentLoaded', ()=>{
        // ×”×’×“×¨×ª ×××–×™× ×™× ×œ×›×¤×ª×•×¨×™×
        $('quickBtn').addEventListener('click', ()=>runScan({extended:false}));
        $('fullBtn').addEventListener('click', ()=>runScan({extended:true}));
        
        // ×¡×™××Ÿ ×•×™×–×•××œ×™ ×œ××•×›× ×•×ª
        window.setTimeout(() => {
          $('statusBrief').textContent = '××•×›×Ÿ ×œ×‘×™×¦×•×¢ ×¡×¨×™×§×”';
        }, 500);
    });

  </script>
</body>
</html>