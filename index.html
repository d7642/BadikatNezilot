<!doctype html>
<html lang="he" dir="rtl">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title data-i18n="title">CyberScan Pro â€” Web Privacy & Fingerprinting Deep Scan</title>

    <!-- ×¡×’× ×•×Ÿ ×××•×—×“ â€“ ××™×Ÿ ×©×™× ×•×™ ××”×•×ª×™ -->
    <style>
        :root {
            --bg: #060709;
            --panel: #0f1216;
            --muted: #98a2ad;
            --accent: #d33b3b;
            --accent2: #1f6feb;
            --good: #39b54a;
            --warn: #ffb86b;
            --bad: #ff5c5c;
            --glass: rgba(255, 255, 255, 0.03);
            --gap: 6px;
            font-family: "Segoe UI", "Helvetica Neue", Arial, system-ui;
        }

        html, body {
            height: 100%;
            margin: 0;
            background: linear-gradient(180deg, #050506 0%, var(--bg) 100%);
            color: #e6eef6;
            scroll-behavior: smooth;
        }
        
        /* ×”×ª×××•×ª ×œ×›×™×•×•× ×™×•×ª ×©×¤×” (RTL/LTR) */
        [dir="ltr"] .recommend-item {
            border-right: none;
            border-left: 3px solid var(--warn);
            padding-left: 8px;
            padding-right: 0;
        }
        [dir="ltr"] .recommend-item.critical {
            border-left-color: var(--bad);
        }
        [dir="ltr"] .logo {
            /* ××•×œ×™ ××™×“×™××œ×™ ×œ×”×¤×•×š ××ª ×”-gradient ×‘-LTR */
        }
        [dir="ltr"] .brand {
            direction: ltr; /* ×©××™×¨×” ×¢×œ ××¨××” ×”-brand ××©×××œ ×œ×™××™×Ÿ */
        }

        .app {
            max-width: 920px;
            margin: 10px auto;
            padding: 10px
        }

        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            flex-wrap: wrap
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 12px;
            direction: rtl; /* ×›×œ×œ ×‘×¨×™×¨×ª ××—×“×œ RTL */
        }

        .logo {
            width: 56px;
            height: 56px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--accent), #7b1515);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 16px
        }

        .brand h1 {
            font-size: 18px;
            margin: 0
        }

        .brand p {
            margin: 0;
            font-size: 12px;
            color: var(--muted)
        }

        .controls {
            display: flex;
            gap: 8px;
            align-items: center
        }

        .btn {
            background: linear-gradient(90deg, var(--accent), #b72626);
            border: 0;
            padding: 12px 18px;
            border-radius: 12px;
            color: white;
            font-weight: 800;
            cursor: pointer;
            transition: transform 0.1s;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
            display: inline-flex;
            align-items: center;
            gap: 8px
        }

        .btn:active {
            transform: scale(0.98)
        }

        .btn.secondary {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.06);
            padding: 10px 14px;
            font-weight: 700;
            box-shadow: none
        }

        .score {
            display: flex;
            align-items: center;
            gap: 10px
        }

        .score .val {
            font-size: 24px;
            font-weight: 900;
            min-width: 40px;
            text-align: center;
        }

        .results {
            margin-top: 12px;
            display: flex;
            flex-direction: column;
            gap: 8px
        }

        .card {
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.02), var(--panel));
            border-radius: 12px;
            padding: 10px 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.6);
            display: flex;
            flex-direction: column;
            gap: 6px
        }

        .card .head {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px
        }

        .card .title {
            font-weight: 800;
            font-size: 14px
        }

        .card .desc {
            font-size: 12px;
            color: var(--muted);
            margin-top: 0
        }

        .brief {
            font-size: 13px;
            color: var(--muted)
        }

        .toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 4px 0;
        }

        .chev {
            transform: rotate(0deg);
            transition: transform .18s;
            color: var(--muted)
        }

        /* ×‘-RTL (×‘×¨×™×¨×ª ××—×“×œ): ×—×¥ ×¤×•× ×” ×©×××œ×”, ×¤×ª×™×—×” ×”×•×¤×š ×œ××˜×” */
        [dir="rtl"] .chev { 
             transform: rotate(180deg);
        }
        [dir="rtl"] .expanded .chev {
            transform: rotate(90deg)
        }
        /* ×‘-LTR ×™×ª×”×¤×š */
        

        .details {
            overflow: hidden;
            max-height: 0;
            transition: max-height .35s ease-out;
            padding-top: 0;
        }

        .expanded .details {
            max-height: 2000px;
            padding-top: 8px
        }

        .row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px
        }

        .badge {
            font-size: 12px;
            padding: 6px 8px;
            border-radius: 8px;
            font-weight: 700;
            min-width: 60px;
            text-align: center
        }

        .badge.good {
            background: rgba(57, 181, 74, 0.12);
            color: var(--good)
        }

        .badge.warn {
            background: rgba(255, 165, 0, 0.12);
            color: var(--warn)
        }

        .badge.bad {
            background: rgba(211, 59, 59, 0.12);
            color: var(--bad)
        }

        .badge.neutral {
            background: rgba(255, 255, 255, 0.02);
            color: var(--muted)
        }

        .list {
            display: flex;
            flex-direction: column;
            gap: 6px;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            padding-top: 8px;
            margin-top: 4px;
        }

        .line {
            display: flex;
            align-items: baseline; /* ×™×™×©×•×¨ × ×•×— ×™×•×ª×¨ */
            justify-content: space-between;
            gap: 10px;
            font-size: 13px;
            /* ×©×™× ×•×™ ×§×˜×Ÿ: ×××¤×©×¨ ×œ×˜×§×¡×˜ ××¨×•×š ×œ×”×ª×¤×¨×¡ ×¢×œ ×©×•×¨×” ×—×“×©×” ×‘×ª×•×š ×”-Div */
            overflow-wrap: break-word;
        }

        .line>div:first-child {
            color: var(--muted);
            min-width: 120px;
            /* ×©××™×¨×ª ×”××™× ×™××•× ×¨×•×—×‘ */
            flex-shrink: 0;
        }
        .line>div:last-child {
            text-align: end;
            /* ×™×™×©×•×¨ ×œ×¦×“ ×”× ×’×“×™ */
        }


        .muted {
            color: var(--muted);
            font-size: 12px
        }
        
        /* ×¡×’× ×•×Ÿ ×”××œ×¦×•×ª ×—×“×© â€“ ×‘×•×œ×˜ ×•×‘×¨×•×¨ */
        .recommendations {
            padding: 10px;
            border-radius: 8px;
            background-color: var(--glass);
            margin-top: 10px;
            border: 1px solid rgba(255,255,255,0.06);
            display:flex;
            flex-direction:column;
            gap:10px;
        }
        .recommendations h4 {
            margin: 0 0 5px 0;
            font-size: 14px;
            font-weight: 800;
            color: var(--accent);
            border-bottom: 2px solid var(--accent);
            padding-bottom: 5px;
            display: inline-block;
        }
        /* ×‘-RTL (×‘×¨×™×¨×ª ××—×“×œ) */
        .recommend-item {
            border-right: 3px solid var(--warn);
            padding-right: 8px;
        }
        .recommend-item.critical {
            border-right-color: var(--bad);
        }
        .recommend-item strong {
            display: block;
            margin-bottom: 3px;
            font-size: 13px;
            color: white;
        }
        .recommend-item p {
            margin: 0;
            font-size: 12px;
            color: var(--muted);
        }
        

        footer {
            margin-top: 18px;
            font-size: 12px;
            color: var(--muted);
            text-align: center
        }

        /* Legal Block Styling */
        .legal-content {
            padding: 10px 0;
        }
        .legal-content h5 {
            font-size: 13px;
            font-weight: 700;
            margin: 0 0 5px 0;
            color: var(--accent2);
        }
        .legal-content p, .legal-content ul {
            font-size: 12px;
            color: var(--muted);
            margin: 5px 0 10px 0;
            padding: 0;
        }
        .legal-content ul {
            list-style-type: none; 
        }

        /* Language Selector Styling */
        .language-selector {
            margin-top: 10px; 
            padding-top: 5px;
            border-top: 1px dashed rgba(255, 255, 255, 0.05); 
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 8px;
            font-size: 12px;
        }
        .language-selector label {
            color: var(--muted);
            font-weight: 600;
        }
        .language-selector select {
            background: var(--panel);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
        }

        /* contact area compact */
        .contact .email-text {
            font-size: 13px;
            color: var(--muted)
        }

        .muted-small {
            font-size: 12px;
            color: var(--muted)
        }

        /* Canvas for fingerprint */
        #canvasTest {
            display: none;
        }
    </style>
</head>

<body>
    <div class="app" role="application" aria-label="CyberScan Pro Privacy Checker">
        <header>
            <div class="brand">
                <div class="logo">CSP</div>
                <div>
                    <h1 data-i18n="appTitle">CyberScan Pro</h1>
                    <p data-i18n="appSubtitle">×‘×“×™×§×•×ª ×¤×¨×˜×™×•×ª ×•×× ×•× ×™××™×•×ª ××œ××•×ª â€” **×›×œ ×ª×•×¦××•×ª ×”×¡×¨×™×§×” ××•×¦×’×•×ª ×›××Ÿ**</p>
                </div>
            </div>

            <div class="controls">
                <div class="score">
                    <div class="val" id="privacyScore" style="color:var(--muted) unset;">â€”</div>
                    <div class="muted-small" data-i18n="scoreLabel">×¦×™×•×Ÿ ×¤×¨×˜×™×•×ª</div>
                </div>
                <!-- ×›×¤×ª×•×¨ ××—×“: ×‘×“×™×§×” ××§×™×¤×” ×›×‘×¨×™×¨×ª ××—×“×œ -->
                <button id="fullBtn" class="btn" data-i18n="fullScanBtn">ğŸ” ×‘×“×™×§×” ××§×™×¤×”</button>
            </div>
        </header>
        
        <!-- ×‘×•×¨×¨ ×©×¤×•×ª -->
        <div class="language-selector">
            <label for="langSelector" data-i18n="languageLabel">×©×¤×”:</label>
            <select id="langSelector">
                <option value="he">×¢×‘×¨×™×ª (Hebrew)</option>
                <option value="en">English (×× ×’×œ×™×ª)</option>
                <!-- × ×™×ª×Ÿ ×œ×”×•×¡×™×£ ×›××Ÿ ×¢×•×“ ×©×¤×•×ª -->
            </select>
        </div>


        <div class="results" id="results">
            <div class="card" id="statusCard">
                <div class="head">
                    <div>
                        <div class="title" data-i18n="statusTitle">××¦×‘ ×¡×§×™×¨×”</div>
                        <div class="desc" data-i18n="statusDesc">×œ×—×¥ ×¢×œ "×‘×“×™×§×” ××§×™×¤×”" â€” **×›×œ ×”×ª×•×¦××•×ª × ×©××¨×•×ª ×‘×¦×“ ×”×œ×§×•×— (Client-Side)**.</div>
                    </div>
                    <div class="brief" id="statusBrief" data-i18n="statusReady">××•×›×Ÿ ×œ×§×œ×™×˜×”</div>
                </div>
            </div>

            <!-- 1) IP & DNS checks -->
            <div class="card section" id="networkCard">
                <div class="head toggle" data-target="networkCard">
                    <div>
                        <div class="title" data-i18n="networkTitle">×›×ª×•×‘×ª IP, WebRTC ×•-DNS</div>
                        <div class="desc muted" data-i18n="networkDesc">×‘×“×™×§×” ××§×™×¤×” ×œ×“×œ×™×¤×•×ª ×¨×©×ª ×§×¨×™×˜×™×•×ª (IP, DNS)</div>
                    </div>
                    <div class="row">
                        <div class="badge neutral" id="networkBadge" data-i18n="untested">×œ× × ×‘×“×§</div>
                        <div class="chev">â€º</div>
                    </div>
                </div>
                <div class="details">
                    <div class="list" id="publicIpList"></div>
                    <div class="list" id="webrtcList"></div>
                    <div class="list" id="dnsList"></div>
                    <div class="recommendations" id="networkRecs">
                        <h4 data-i18n="recsHeader">×”××œ×¦×•×ª ×ª×™×§×•×Ÿ ×œ×›×¨×˜×™×¡ ×–×”</h4>
                    </div>
                </div>
            </div>

            <!-- 2) Advanced Fingerprinting -->
            <div class="card section" id="fingerprintCard">
                <div class="head toggle" data-target="fingerprintCard">
                    <div>
                        <div class="title" data-i18n="fpTitle">Web Fingerprinting ××ª×§×“×</div>
                        <div class="desc muted" data-i18n="fpDesc">××“×™×“×ª ×™×™×—×•×“×™×•×ª ×”×”×ª×§×Ÿ (Canvas, WebGL, Fonts)</div>
                    </div>
                    <div class="row">
                        <div class="badge neutral" id="fingerprintBadge" data-i18n="untested">×œ× × ×‘×“×§</div>
                        <div class="chev">â€º</div>
                    </div>
                </div>
                <div class="details">
                    <div class="list" id="generalFpList"></div>
                    <div class="list" id="canvasFpList"></div>
                    <div class="list" id="webglFpList"></div>
                    <div class="recommendations" id="fingerprintRecs">
                        <h4 data-i18n="recsHeader">×”××œ×¦×•×ª ×ª×™×§×•×Ÿ ×œ×›×¨×˜×™×¡ ×–×”</h4>
                    </div>
                </div>
            </div>

            <!-- 3) Storage & Tracking -->
            <div class="card section" id="cookiesCard">
                <div class="head toggle" data-target="cookiesCard">
                    <div>
                        <div class="title" data-i18n="cookiesTitle">××—×¡×•×Ÿ ××§×•××™ ×•×¢×§×™×‘×•×ª (Tracking)</div>
                        <div class="desc muted" data-i18n="cookiesDesc">×¢×•×’×™×•×ª (Cookies), LocalStorage, SessionStorage</div>
                    </div>
                    <div class="row">
                        <div class="badge neutral" id="cookiesBadge" data-i18n="untested">×œ× × ×‘×“×§</div>
                        <div class="chev">â€º</div>
                    </div>
                </div>
                <div class="details">
                    <div class="list" id="cookiesList"></div>
                    <div class="list" id="storageList"></div>
                    <div class="recommendations" id="cookiesRecs">
                        <h4 data-i18n="recsHeader">×”××œ×¦×•×ª ×ª×™×§×•×Ÿ ×œ×›×¨×˜×™×¡ ×–×”</h4>
                    </div>
                </div>
            </div>

            <!-- 4) Browser & System Details -->
            <div class="card section" id="browserCard">
                <div class="head toggle" data-target="browserCard">
                    <div>
                        <div class="title" data-i18n="browserTitle">×“×¤×“×¤×Ÿ, ××¢×¨×›×ª ×”×¤×¢×œ×” ×•×‘×™×¦×•×¢×™×</div>
                        <div class="desc muted" data-i18n="browserDesc">UserAgent, ×©×¤×•×ª, ×¨×›×™×‘×™ ×—×•××¨×” ×•×‘×™×¦×•×¢×™×</div>
                    </div>
                    <div class="row">
                        <div class="badge neutral" id="browserBadge" data-i18n="untested">×œ× × ×‘×“×§</div>
                        <div class="chev">â€º</div>
                    </div>
                </div>
                <div class="details">
                    <div class="list" id="browserList"></div>
                    <div class="list" id="hardwareList"></div>
                    <div class="list" id="timingList"></div>
                    <div class="recommendations" id="browserRecs">
                        <h4 data-i18n="recsHeader">×”××œ×¦×•×ª ×ª×™×§×•×Ÿ ×œ×›×¨×˜×™×¡ ×–×”</h4>
                    </div>
                </div>
            </div>

            <!-- 5) Network Ports & Connectivity -->
            <div class="card section" id="portsCard">
                <div class="head toggle" data-target="portsCard">
                    <div>
                        <div class="title" data-i18n="portsTitle">×¡×§×™×¨×ª ×¤×•×¨×˜×™× ××§×•××™×ª (Port Scanning)</div>
                        <div class="desc muted" data-i18n="portsDesc">× ×™×¡×™×•× ×•×ª ×’×™×©×” ×‘×˜×•×—×™× ×œ×¤×•×¨×˜×™× ××§×•××™×™× (127.0.0.1)</div>
                    </div>
                    <div class="row">
                        <div class="badge neutral" id="portsBadge" data-i18n="untested">×œ× × ×‘×“×§</div>
                        <div class="chev">â€º</div>
                    </div>
                </div>
                <div class="details">
                    <div class="list" id="portsList"></div>
                    <div class="recommendations" id="portsRecs">
                        <h4 data-i18n="recsHeader">×”××œ×¦×•×ª ×ª×™×§×•×Ÿ ×œ×›×¨×˜×™×¡ ×–×”</h4>
                    </div>
                </div>
            </div>

            <!-- 6) Security Headers & TLS -->
            <div class="card section" id="tlsCard">
                <div class="head toggle" data-target="tlsCard">
                    <div>
                        <div class="title" data-i18n="tlsTitle">××‘×˜×—×ª ×—×™×‘×•×¨ (TLS / HTTPS)</div>
                        <div class="desc muted" data-i18n="tlsDesc">×‘×“×™×§×•×ª ×‘×¡×™×¡×™×•×ª ×œ×’×‘×™ ×× ×’× ×•× ×™ ×”×¦×¤× ×” ×•×¤×¨×•×˜×•×§×•×œ</div>
                    </div>
                    <div class="row">
                        <div class="badge neutral" id="tlsBadge" data-i18n="untested">×œ× × ×‘×“×§</div>
                        <div class="chev">â€º</div>
                    </div>
                </div>
                <div class="details">
                    <div class="list" id="tlsList"></div>
                    <div class="recommendations" id="tlsRecs">
                        <h4 data-i18n="recsHeader">×”××œ×¦×•×ª ×ª×™×§×•×Ÿ ×œ×›×¨×˜×™×¡ ×–×”</h4>
                    </div>
                </div>
            </div>

            <!-- 7) Legal and Privacy (×—×•×‘×” ×¢×œ ×¤×™ ×”×—×•×§) -->
            <div class="card section" id="legalCard">
                <div class="head toggle" data-target="legalCard">
                    <div>
                        <div class="title" data-i18n="legalTitle">×ª× ××™ ×©×™××•×© ×•××“×™× ×™×•×ª ×¤×¨×˜×™×•×ª</div>
                        <div class="desc muted" data-i18n="legalDesc">×—×•×‘×” ×—×•×§×™×ª ×œ×›×œ ×›×œ×™ ×‘×“×™×§×” | **×”×ª×•×›×Ÿ ××—×™×™×‘ ×¢×“×›×•×Ÿ ××©×¤×˜×™**</div>
                    </div>
                    <div class="row">
                        <div class="badge good" data-i18n="legalRequired">× ×“×¨×©</div>
                        <div class="chev">â€º</div>
                    </div>
                </div>
                <div class="details" style="max-height:400px;padding-top:6px;">
                    <div class="legal-content">
                        <h5 data-i18n="termsOfServiceHeader">×ª× ××™ ×©×™××•×© (Terms of Service)</h5>
                        <p data-i18n="termsOfServiceContent">
                            **×œ×ª×©×•××ª ×œ×‘×š:** ×”×ª×•×›×Ÿ ×‘×“×£ ×–×” ×”×•× placeholder ×•××™× ×• ××”×•×•×” ×™×™×¢×•×¥ ××©×¤×˜×™. ×¢×œ×™×š ×œ×”×ª×™×™×¢×¥ ×¢× ×¢×•×¨×š ×“×™×Ÿ
                            ×›×“×™ ×œ×™×¦×•×¨ ×ª× ××™ ×©×™××•×© ××—×™×™×‘×™×. ×× ×• ×× ×™×—×™× ×©××©×ª××© ×–×” ×¤×•×¢×œ ××˜×¢× ×—×‘×¨×” ×•××•×¨×©×” ×œ×‘×¦×¢ ×‘×“×™×§×•×ª ×¢×œ × ×›×¡×™
                            ×”×—×‘×¨×”.
                            <ul>
                                <li data-i18n="term1">1. ×”×›×œ×™ ×¤×•×¢×œ ×‘×¦×“ ×”×œ×§×•×— ×‘×œ×‘×“ ×•××™× ×• ×©×•×œ×— × ×ª×•× ×™× ×œ×©×¨×ª ×›×œ×©×”×•.</li>
                                <li data-i18n="term2">2. ×”××©×ª××© ×¨×©××™ ×œ×”×©×ª××© ×‘×›×œ×™ ×–×” ××š ×•×¨×§ ×œ×‘×“×™×§×ª × ×›×¡×™× ×©×‘×‘×¢×œ×•×ª×• ×•/××• ×‘×¨×©×•×ª×• ×•/××• ×‘××™×©×•×¨ ××¤×•×¨×© ××”×‘×¢×œ×™×.</li>
                                <li data-i18n="term3">3. ××™×Ÿ ×œ×”×©×ª××© ×‘×›×œ×™ ×–×” ×œ××˜×¨×•×ª ×–×“×•× ×™×•×ª (Malicious Use) ××• ×‘× ×™×’×•×“ ×œ×—×•×§ ×”××§×•××™ (Local Law).</li>
                            </ul>
                        </p>
                        
                        <h5 data-i18n="privacyPolicyHeader">××“×™× ×™×•×ª ×¤×¨×˜×™×•×ª (Privacy Policy)</h5>
                        <p data-i18n="privacyPolicyContent">
                            **×”×¦×”×¨×” ××©×¤×˜×™×ª:** ××“×™× ×™×•×ª ×¤×¨×˜×™×•×ª ×–×• ×”×™× ×“×•×’××” ×‘×œ×‘×“. ×™×© ×œ×”×—×œ×™×£ ×‘×ª×•×›×Ÿ ×¨×©××™.
                            × ×•×›×— ×”×¢×•×‘×“×” ×©×”×›×œ×™ ×¤×•×¢×œ ×‘××•×¤×Ÿ ××œ× ×‘×¦×“ ×”×œ×§×•×— (Client-Side), ××™×Ÿ ××™×¡×•×£, ×©××™×¨×” ××• ×¢×™×‘×•×“ ×©×œ × ×ª×•× ×™× ××™×©×™×™×
                            ××›×œ ×¡×•×’ ×¢×œ ×™×“×™ ××¢×¨×›×ª CyberScan Pro. ×œ×›×Ÿ, ××™×Ÿ ×¦×•×¨×š ×‘×× ×’× ×•×Ÿ ××—×™×§×ª × ×ª×•× ×™×
                            ×‘×¦×“ ×”×©×¨×ª.
                        </p>
                    </div>
                    <div class="recommendations" id="legalRecs">
                        <h4>×¤×ª×¨×•×Ÿ ××©×¤×˜×™</h4>
                        <div class="recommend-item critical">
                            <strong>×—×•×‘×”: ×™×™×¢×•×¥ ××©×¤×˜×™ ×¢×“×›× ×™</strong>
                            <p>
                                **×”×¡×‘×¨:** ××¡××›×™× ××©×¤×˜×™×™× ×”× ×§×¨×™×˜×™×™× ×•× ×“×¨×©×™× ×¢×œ ×¤×™ ×—×•×§×™ GDPR, CCPA ×•×—×•×§×™ ×”×’× ×ª ×¤×¨×˜×™×•×ª ××§×•××™×™× ×¨×‘×™×.
                                <br>
                                **×¤×ª×¨×•×Ÿ:** ×¤× ×” ××™×“×™×ª ×œ×¢×•×¨×š ×“×™×Ÿ ×”××ª××—×” ×‘×ª×—×•× ×”××‘×˜×—×” ×•×¤×¨×˜×™×•×ª ×”××™×“×¢ ×©×™×¡×¤×§ ×œ×š ×ª× ××™ ×©×™××•×© ×•××“×™× ×™×•×ª ×¤×¨×˜×™×•×ª
                                ××§×™×¤×™× ×•×ª×§×¤×™× ××©×¤×˜×™×ª.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contact area -->
            <div class="card" id="contactCard">
               <div class="head toggle" data-target="contactCard" style="cursor:pointer; padding:4px 0;">
                    <div>
                        <div class="title" data-i18n="contactTitle">×™×¦×™×¨×ª ×§×©×¨ ×¢× ×”××¤×ª×—×™×</div>
                        <div class="desc muted" data-i18n="contactDesc">×”×•×“×¢×•×ª ×™×•×¤× ×• ×œ×›×ª×•×‘×ª ×”××™×™×œ ×”××•×¡×•×•×™×ª ×©×œ ×”××¤×ª×—.</div>
                    </div>
                    <div class="row">
                        <div class="contact">
                            <div class="icon" title="×©×œ×— ××™××™×™×œ">âœ‰ï¸</div>
                            <div class="email-text" id="emailText">hacker[dot]david[at]gmail[dot]com</div>
                        </div>
                        <div class="chev">â€º</div>
                    </div>
                </div>
                 <div class="details" style="max-height:400px;padding-top:6px;">
                    <form id="contactForm" class="contact-form" onsubmit="return handleContactSubmit(event)">
                        <input id="cf_name" data-i18n-placeholder="cf_name_placeholder" placeholder="×©×" required />
                        <input id="cf_subject" data-i18n-placeholder="cf_subject_placeholder" placeholder="× ×•×©×" required />
                        <textarea id="cf_message" data-i18n-placeholder="cf_message_placeholder" placeholder="×”×•×“×¢×”" rows="4" required></textarea>
                        <div
                            style="display:flex;justify-content:space-between;align-items:center;gap:8px;margin-top:8px;">
                            <div class="muted-small" data-i18n="contactWarning">×”×•×“×¢×” ×ª×¢×‘×•×¨ ×œ×ª×•×›× ×ª ×“×•××¨ ××œ×§×˜×¨×•× ×™ ××§×•××™×ª â€” **×œ× × ×©×œ×—×ª ×™×©×™×¨×•×ª ×œ×©×¨×ª ×¡×•×“×™**.
                            </div>
                            <button class="btn" type="submit" data-i18n="sendEmailBtn">×©×œ×— ×“×¨×š ×ª×•×›× ×ª ×“×•××¨</button>
                        </div>
                    </form>
                </div>
            </div>


            <!-- ×¨×›×™×‘ × ×¡×ª×¨ ×œ-Canvas Fingerprinting -->
            <canvas id="canvasTest" width="300" height="30"></canvas>

        </div>

        <!-- ×”×•×“×¢×ª ×©×§×™×¤×•×ª ×§×¨×™×˜×™×ª -->
        <footer data-i18n="footerWarning">
            <p>âš ï¸ **×”×¦×”×¨×ª ×©×§×™×¤×•×ª:** ××™×Ÿ ×©×™××•×© ×‘×©×¨×ª×™× ×—×™×¦×•× ×™×™× ×œ××™×¡×•×£ × ×ª×•× ×™×. ×›×œ ×”×‘×“×™×§×•×ª ×”×œ×œ×• (×›×•×œ×œ ×”-IP ×•-WebRTC)
                ××‘×•×¦×¢×•×ª ×¢×œ ×™×“×™ ×”×“×¤×“×¤×Ÿ ×©×œ×›× ×‘×œ×‘×“ ×•××™×•×¢×“×•×ª ××š ×•×¨×§ ×œ×”×¦×’×ª ×”××™×“×¢ **×œ×›×** ×¢×œ ×”××¡×š. ×”× ×ª×•× ×™× ×œ× × ×©××¨×™×,
                ××©×•×“×¨×™× ××• ××•×’×“×¨×™× ×‘×¦×“ ×”×©×¨×ª. Â© CyberScan Pro â€” ×¤×•×ª×— ×¢×œ ×™×“×™ ××•××—×™ ××‘×˜×—×ª ××™×“×¢ ×××•×©×¨×™×.</p>
        </footer>
    </div>

    <script>
        // === ××•×‘×™×™×§×˜ i18n: Globalization and Localization ===

        const i18n = {
            'he': {
                // UI Static Texts
                title: 'CyberScan Pro â€” ×‘×“×™×§×ª ×¤×¨×˜×™×•×ª ×•×˜×‘×™×¢×ª ××¦×‘×¢ ××¢××™×§×”',
                appTitle: 'CyberScan Pro',
                appSubtitle: '×‘×“×™×§×•×ª ×¤×¨×˜×™×•×ª ×•×× ×•× ×™××™×•×ª ××œ××•×ª â€” **×›×œ ×ª×•×¦××•×ª ×”×¡×¨×™×§×” ××•×¦×’×•×ª ×›××Ÿ**',
                scoreLabel: '×¦×™×•×Ÿ ×¤×¨×˜×™×•×ª',
                fullScanBtn: 'ğŸ” ×‘×“×™×§×” ××§×™×¤×”',
                statusTitle: '××¦×‘ ×¡×§×™×¨×”',
                statusDesc: '×œ×—×¥ ×¢×œ "×‘×“×™×§×” ××§×™×¤×”" â€” **×›×œ ×”×ª×•×¦××•×ª × ×©××¨×•×ª ×‘×¦×“ ×”×œ×§×•×— (Client-Side)**.',
                statusReady: '××•×›×Ÿ ×œ×§×œ×™×˜×”',
                statusScanning: '××‘×¦×¢ ×¡×¨×™×§×” (×”××ª×Ÿ ×‘×¡×‘×œ× ×•×ª)...',
                statusComplete: (score) => `×”×¡×¨×™×§×” ×”×•×©×œ××”. ×¦×™×•×Ÿ ×¡×•×¤×™: ${score}/100`,
                untested: '×œ× × ×‘×“×§',
                
                // Section Titles
                networkTitle: '×›×ª×•×‘×ª IP, WebRTC ×•-DNS',
                networkDesc: '×‘×“×™×§×” ××§×™×¤×” ×œ×“×œ×™×¤×•×ª ×¨×©×ª ×§×¨×™×˜×™×•×ª (IP, DNS)',
                fpTitle: 'Web Fingerprinting ××ª×§×“×',
                fpDesc: '××“×™×“×ª ×™×™×—×•×“×™×•×ª ×”×”×ª×§×Ÿ (Canvas, WebGL, Fonts)',
                cookiesTitle: '××—×¡×•×Ÿ ××§×•××™ ×•×¢×§×™×‘×•×ª (Tracking)',
                cookiesDesc: '×¢×•×’×™×•×ª (Cookies), LocalStorage, SessionStorage',
                browserTitle: '×“×¤×“×¤×Ÿ, ××¢×¨×›×ª ×”×¤×¢×œ×” ×•×‘×™×¦×•×¢×™×',
                browserDesc: 'UserAgent, ×©×¤×•×ª, ×¨×›×™×‘×™ ×—×•××¨×” ×•×‘×™×¦×•×¢×™×',
                portsTitle: '×¡×§×™×¨×ª ×¤×•×¨×˜×™× ××§×•××™×ª (Port Scanning)',
                portsDesc: '× ×™×¡×™×•× ×•×ª ×’×™×©×” ×‘×˜×•×—×™× ×œ×¤×•×¨×˜×™× ××§×•××™×™× (127.0.0.1)',
                tlsTitle: '××‘×˜×—×ª ×—×™×‘×•×¨ (TLS / HTTPS)',
                tlsDesc: '×‘×“×™×§×•×ª ×‘×¡×™×¡×™×•×ª ×œ×’×‘×™ ×× ×’× ×•× ×™ ×”×¦×¤× ×” ×•×¤×¨×•×˜×•×§×•×œ',
                legalTitle: '×ª× ××™ ×©×™××•×© ×•××“×™× ×™×•×ª ×¤×¨×˜×™×•×ª',
                legalDesc: '×—×•×‘×” ×—×•×§×™×ª ×œ×›×œ ×›×œ×™ ×‘×“×™×§×” | **×”×ª×•×›×Ÿ ××—×™×™×‘ ×¢×“×›×•×Ÿ ××©×¤×˜×™**',
                legalRequired: '× ×“×¨×©',
                
                // Recommendations and Contact
                recsHeader: '×”××œ×¦×•×ª ×ª×™×§×•×Ÿ ×œ×›×¨×˜×™×¡ ×–×”',
                contactTitle: '×™×¦×™×¨×ª ×§×©×¨ ×¢× ×”××¤×ª×—×™×',
                contactDesc: '×”×•×“×¢×•×ª ×™×•×¤× ×• ×œ×›×ª×•×‘×ª ×”××™×™×œ ×”××•×¡×•×•×™×ª ×©×œ ×”××¤×ª×—.',
                cf_name_placeholder: '×©×',
                cf_subject_placeholder: '× ×•×©×',
                cf_message_placeholder: '×”×•×“×¢×”',
                contactWarning: '×”×•×“×¢×” ×ª×¢×‘×•×¨ ×œ×ª×•×›× ×ª ×“×•××¨ ××œ×§×˜×¨×•× ×™ ××§×•××™×ª â€” **×œ× × ×©×œ×—×ª ×™×©×™×¨×•×ª ×œ×©×¨×ª ×¡×•×“×™**.',
                sendEmailBtn: '×©×œ×— ×“×¨×š ×ª×•×›× ×ª ×“×•××¨',
                
                // Legal Block Content
                termsOfServiceHeader: '×ª× ××™ ×©×™××•×© (Terms of Service)',
                termsOfServiceContent: '**×œ×ª×©×•××ª ×œ×‘×š:** ×”×ª×•×›×Ÿ ×‘×“×£ ×–×” ×”×•× placeholder ×•××™× ×• ××”×•×•×” ×™×™×¢×•×¥ ××©×¤×˜×™. ×¢×œ×™×š ×œ×”×ª×™×™×¢×¥ ×¢× ×¢×•×¨×š ×“×™×Ÿ ×›×“×™ ×œ×™×¦×•×¨ ×ª× ××™ ×©×™××•×© ××—×™×™×‘×™×. ×× ×• ×× ×™×—×™× ×©××©×ª××© ×–×” ×¤×•×¢×œ ××˜×¢× ×—×‘×¨×” ×•××•×¨×©×” ×œ×‘×¦×¢ ×‘×“×™×§×•×ª ×¢×œ × ×›×¡×™ ×”×—×‘×¨×”.',
                term1: '1. ×”×›×œ×™ ×¤×•×¢×œ ×‘×¦×“ ×”×œ×§×•×— ×‘×œ×‘×“ ×•××™× ×• ×©×•×œ×— × ×ª×•× ×™× ×œ×©×¨×ª ×›×œ×©×”×•.',
                term2: '2. ×”××©×ª××© ×¨×©××™ ×œ×”×©×ª××© ×‘×›×œ×™ ×–×” ××š ×•×¨×§ ×œ×‘×“×™×§×ª × ×›×¡×™× ×©×‘×‘×¢×œ×•×ª×• ×•/××• ×‘×¨×©×•×ª×• ×•/××• ×‘××™×©×•×¨ ××¤×•×¨×© ××”×‘×¢×œ×™×.',
                term3: '3. ××™×Ÿ ×œ×”×©×ª××© ×‘×›×œ×™ ×–×” ×œ××˜×¨×•×ª ×–×“×•× ×™×•×ª (Malicious Use) ××• ×‘× ×™×’×•×“ ×œ×—×•×§ ×”××§×•××™ (Local Law).',
                privacyPolicyHeader: '××“×™× ×™×•×ª ×¤×¨×˜×™×•×ª (Privacy Policy)',
                privacyPolicyContent: '**×”×¦×”×¨×” ××©×¤×˜×™×ª:** ××“×™× ×™×•×ª ×¤×¨×˜×™×•×ª ×–×• ×”×™× ×“×•×’××” ×‘×œ×‘×“. ×™×© ×œ×”×—×œ×™×£ ×‘×ª×•×›×Ÿ ×¨×©××™. × ×•×›×— ×”×¢×•×‘×“×” ×©×”×›×œ×™ ×¤×•×¢×œ ×‘××•×¤×Ÿ ××œ× ×‘×¦×“ ×”×œ×§×•×— (Client-Side), ××™×Ÿ ××™×¡×•×£, ×©××™×¨×” ××• ×¢×™×‘×•×“ ×©×œ × ×ª×•× ×™× ××™×©×™×™× ××›×œ ×¡×•×’ ×¢×œ ×™×“×™ ××¢×¨×›×ª CyberScan Pro. ×œ×›×Ÿ, ××™×Ÿ ×¦×•×¨×š ×‘×× ×’× ×•×Ÿ ××—×™×§×ª × ×ª×•× ×™× ×‘×¦×“ ×”×©×¨×ª.',

                // Footer
                footerWarning: 'âš ï¸ **×”×¦×”×¨×ª ×©×§×™×¤×•×ª:** ××™×Ÿ ×©×™××•×© ×‘×©×¨×ª×™× ×—×™×¦×•× ×™×™× ×œ××™×¡×•×£ × ×ª×•× ×™×. ×›×œ ×”×‘×“×™×§×•×ª ×”×œ×œ×• (×›×•×œ×œ ×”-IP ×•-WebRTC) ××‘×•×¦×¢×•×ª ×¢×œ ×™×“×™ ×”×“×¤×“×¤×Ÿ ×©×œ×›× ×‘×œ×‘×“ ×•××™×•×¢×“×•×ª ××š ×•×¨×§ ×œ×”×¦×’×ª ×”××™×“×¢ **×œ×›×** ×¢×œ ×”××¡×š. ×”× ×ª×•× ×™× ×œ× × ×©××¨×™×, ××©×•×“×¨×™× ××• ××•×’×“×¨×™× ×‘×¦×“ ×”×©×¨×ª. Â© CyberScan Pro â€” ×¤×•×ª×— ×¢×œ ×™×“×™ ××•××—×™ ××‘×˜×—×ª ××™×“×¢ ×××•×©×¨×™×.',
                languageLabel: '×©×¤×”:',
                
                // Rec Texts (Not for full translation, only key findings)
                cleanRecText: '× ×§×™: × ×¨××” ×›×™ ×œ× × ××¦××• × ×•×©××™ ××‘×˜×—×” ××• ×¤×¨×˜×™×•×ª ×§×¨×™×˜×™×™× ×‘×›×¨×˜×™×¡ ×–×”.',
            },
            'en': {
                // UI Static Texts
                title: 'CyberScan Pro â€” Deep Privacy and Fingerprinting Check',
                appTitle: 'CyberScan Pro',
                appSubtitle: 'Full Privacy & Anonymity Scans â€” **All Scan Results are Displayed Here**',
                scoreLabel: 'Privacy Score',
                fullScanBtn: 'ğŸ” Full Scan',
                statusTitle: 'Scan Status',
                statusDesc: 'Click "Full Scan" â€” **All results remain Client-Side**.',
                statusReady: 'Ready to Scan',
                statusScanning: 'Performing Scan (Please wait patiently)...',
                statusComplete: (score) => `Scan complete. Final Score: ${score}/100`,
                untested: 'Untested',

                // Section Titles
                networkTitle: 'IP Address, WebRTC & DNS',
                networkDesc: 'Comprehensive checks for critical network leaks (IP, DNS)',
                fpTitle: 'Advanced Web Fingerprinting',
                fpDesc: 'Measuring device uniqueness (Canvas, WebGL, Fonts)',
                cookiesTitle: 'Local Storage & Tracking',
                cookiesDesc: 'Cookies, LocalStorage, SessionStorage',
                browserTitle: 'Browser, OS, and Performance',
                browserDesc: 'UserAgent, languages, hardware components, and performance',
                portsTitle: 'Local Port Scanning',
                portsDesc: 'Safe attempts to access local ports (127.0.0.1)',
                tlsTitle: 'Connection Security (TLS / HTTPS)',
                tlsDesc: 'Basic checks for encryption and protocol mechanisms',
                legalTitle: 'Terms of Service and Privacy Policy',
                legalDesc: 'Legal requirement for any testing tool | **Content requires legal update**',
                legalRequired: 'Required',
                
                // Recommendations and Contact
                recsHeader: 'Mitigation Recommendations for this Card',
                contactTitle: 'Contact the Developers',
                contactDesc: 'Messages will be directed to the obfuscated developer email address.',
                cf_name_placeholder: 'Name',
                cf_subject_placeholder: 'Subject',
                cf_message_placeholder: 'Message',
                contactWarning: 'Message will be sent via local email software â€” **it is NOT sent directly to any secret server**.',
                sendEmailBtn: 'Send via Mail Client',
                
                // Legal Block Content
                termsOfServiceHeader: 'Terms of Service',
                termsOfServiceContent: '**Please Note:** The content on this page is a placeholder and does not constitute legal advice. You must consult an attorney to create binding Terms of Service. We assume this user is acting on behalf of a company and is authorized to test company assets.',
                term1: '1. The tool operates client-side only and does not transmit data to any server.',
                term2: '2. The user is permitted to use this tool only for testing assets that they own, are authorized to test, or have explicit permission from the owner.',
                term3: '3. Do not use this tool for malicious purposes or in violation of local law.',
                privacyPolicyHeader: 'Privacy Policy',
                privacyPolicyContent: '**Legal Statement:** This Privacy Policy is an example only. It must be replaced with official content. Given that the tool operates entirely client-side, CyberScan Pro does not collect, save, or process any personal data. Therefore, there is no need for a server-side data deletion mechanism.',

                // Footer
                footerWarning: 'âš ï¸ **Transparency Statement:** No external servers are used for data collection. All these checks (including IP and WebRTC) are performed by your browser only and are intended solely for display to **YOU** on the screen. Data is not saved, transmitted, or configured server-side. Â© CyberScan Pro â€” Developed by certified security experts.',
                languageLabel: 'Language:',
                
                // Rec Texts (Not for full translation, only key findings)
                cleanRecText: 'Clean: No critical security or privacy issues were found in this card.',
            }
            // ×”×•×¡×¤×ª ×©×¤×•×ª × ×•×¡×¤×•×ª ×›××Ÿ
        };

        // === ×¤×•× ×§×¦×™×•×ª ×œ×•×§×œ×™×–×¦×™×” ×•×©×™× ×•×™ ×›×™×•×•× ×™×•×ª (RTL/LTR) ===
        let currentLang = 'he'; // ×‘×¨×™×¨×ª ×”××—×“×œ

        function setLanguage(lang) {
            currentLang = lang;
            const dir = lang === 'he' ? 'rtl' : 'ltr';
            document.documentElement.lang = lang;
            document.documentElement.dir = dir;
            translateUI(lang);
        }

        function translateUI(lang) {
            const texts = i18n[lang];

            // 1. ×ª×¨×’×•× ×œ×¤×™ data-i18n
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (texts[key]) {
                    el.textContent = texts[key];
                }
            });

            // 2. ×ª×¨×’×•× Placeholders
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (texts[key]) {
                    el.setAttribute('placeholder', texts[key]);
                }
            });

            // 3. ×ª×¨×’×•× Title (××˜×•×¤×œ ×‘× ×¤×¨×“ ×›×™ ×”×•× ×œ× ×˜×§×¡×˜ ×¤× ×™××™)
             document.title = texts.title;
        }

        // === ×ª×¦×•×¨×” ×›×œ×œ×™×ª ×•×§×‘×•×¢×™× ××§×¦×•×¢×™×™× ===
        const CONFIG = {
            CONTACT_EMAIL_OBFUSCATED: "Hacker[dot]david[at]gmail[dot]com",
            COMMON_LOCAL_PORTS: [21, 22, 23, 80, 443, 8080, 8443, 3000],
            IP_CHECK_API: 'https://api.ipify.org?format=json',
            DNS_TRACE_API: 'https://cloudflare.com/cdn-cgi/trace',
        };

        // ×¤×•× ×§×¦×™×™×ª ×¢×–×¨ ×›×œ×œ×™×ª ×œ×‘×—×™×¨×ª ××œ×× ×˜×™×
        const $ = id => document.getElementById(id);


        // === ××—×¡×Ÿ ×”×™×“×¢: ×”×¡×‘×¨×™× ×•×”××œ×¦×•×ª ×ª×™×§×•×Ÿ ××•×ª×××•×ª (× ×©××¨ ×‘×¢×‘×¨×™×ª ×œ××¢×Ÿ ×‘×”×™×¨×•×ª) ===
        // ×× × ×¨×¦×” ×œ×ª×¨×’× ××ª ×–×”, ×™×© ×œ×©×›×¤×œ ××ª ×›×œ ×”××•×‘×™×™×§×˜ ×œ×›×œ ×©×¤×”.

        const RecommendationStore = {
            // ==== 1. ×¨×©×ª ×•-IP ====
            PUBLIC_IP_EXPOSED: {
                title: '×›×ª×•×‘×ª IP ×¦×™×‘×•×¨×™×ª ×’×œ×•×™×”',
                explanation: '×›×ª×•×‘×ª ×”-IP ×”×¦×™×‘×•×¨×™×ª ×©×œ×›× ×’×œ×•×™×” ×œ×›×œ ××ª×¨ ×‘×¨×©×ª, ×•×—×•×©×¤×ª ××ª ×”××™×§×•× ×”×›×œ×œ×™ ×©×œ×›× ×•××ª ×¡×¤×§×™×ª ×”××™× ×˜×¨× ×˜. ×–×”×• × ×ª×•×Ÿ ×‘×¡×™×¡×™ ××š ×—×©×•×‘ ×œ×× ×•× ×™××™×•×ª.',
                fix: '×”×©×ª××©×• ×‘×©×™×¨×•×ª VPN ××™×›×•×ª×™ (Virtual Private Network) ××• ×¤×¨×•×§×¡×™ ×××•××ª, ×•×•×“××• ×©×”×•× ×¤×¢×™×œ ×œ×¤× ×™ ×›×œ ×’×œ×™×©×”.',
                critical: false
            },
            WEBRTC_LOCAL_LEAK: {
                title: '×“×œ×™×¤×ª IP ×¤×¨×˜×™ (WebRTC)',
                explanation: 'WebRTC (Web Real-Time Communication) ×¢×œ×•×œ ×œ×—×©×•×£ ××ª ×›×ª×•×‘×ª ×”-IP ×”××§×•××™×ª (Private) ××• ×”×¦×™×‘×•×¨×™×ª ×”×××™×ª×™×ª ×©×œ×›×, ×’× ×›××©×¨ ×”-VPN ×¤×¢×™×œ. ×“×œ×™×¤×” ×–×• ×¢×•×§×¤×ª ×œ×¨×•×‘ ××ª ×”×’× ×•×ª ×”-Proxy.',
                fix: '×”×ª×§×™× ×• ×ª×•×¡×£ ×œ×“×¤×“×¤×Ÿ ×”×—×•×¡× ××• ××©×‘×™×ª ××ª ×× ×’× ×•×Ÿ WebRTC, ××• ×’×œ×©×• ×‘×“×¤×“×¤×Ÿ ×”××•×’×“×¨ ×œ×—×¡×•× WebRTC (×›×’×•×Ÿ Tor ××• Firefox ×¢× ×”×’×“×¨×•×ª ×¤×¨×˜×™×•×ª ××—××™×¨×•×ª).',
                critical: true
            },
            DNS_TRACING: {
                title: '×™×›×•×œ×ª ×¢×§×™×‘×ª DNS',
                explanation: '×©×¨×ª ×”-DNS ×©×œ×›× × ×—×©×£, ×•×›×š ××¤×¢×™×œ ×”××ª×¨ ×™×›×•×œ ×œ×–×”×•×ª ××•×œ ××™×–×” ×¡×¤×§ ×©×™×¨×•×ª×™× ××ª× ×¢×•×‘×“×™×, ××” ×©××¤×—×™×ª ××ª ×”×× ×•× ×™××™×•×ª ×©×œ×›×.',
                fix: '×”×©×ª××©×• ×‘-VPN ×”××¦×™×¢ ×©×¨×ª×™ DNS ×¤×¨×˜×™×™× ××©×œ×•, ××• ×©×§×œ×• ×œ×”×©×ª××© ×‘-DNS ×××•×‘×˜×— ×›×’×•×Ÿ DNS over HTTPS (DoH) ×‘×“×¤×“×¤×Ÿ (×›×’×•×Ÿ Cloudflare 1.1.1.1).',
                critical: false
            },
            // ==== 2. Web Fingerprinting ====
            CANVAS_FINGERPRINT: {
                title: '×˜×‘×™×¢×ª ××¦×‘×¢ ×’×¨×¤×™×ª (Canvas)',
                explanation: '×”×“×¤×“×¤×Ÿ ×©×œ×›× ××¦×™×’ ×˜×‘×™×¢×ª ××¦×‘×¢ ×™×™×—×•×“×™×ª ×“×¨×š ××•×¤×Ÿ ×¨×™× ×“×•×¨ ×”×¤×™×§×¡×œ×™× (Canvas Rendering). × ×ª×•×Ÿ ×–×” × ×©××¨ ×§×‘×•×¢ ×•××©××© ×œ××¢×§×‘ ××¨×•×š ×˜×•×•×—, ×’× ×× ××ª× ××•×—×§×™× ×¢×•×’×™×•×ª.',
                fix: '×”×ª×§×™× ×• ×ª×•×¡×£ ×›×’×•×Ÿ CanvasBlocker ××• ×”×©×ª××©×• ×‘×“×¤×“×¤× ×™× ×”××—×™×œ×™× ×©×™× ×•×™×™× ×¨× ×“×•××œ×™×™× ×¢×œ × ×ª×•× ×™ ×”×§× ×‘×¡ ×›×“×™ ×œ×”×§×©×•×ª ×¢×œ ×”××¢×§×‘.',
                critical: true
            },
            WEBGL_FINGERPRINT: {
                title: '×˜×‘×™×¢×ª ××¦×‘×¢ ×©×œ ×›×¨×˜×™×¡ ×”××¡×š (WebGL)',
                explanation: '×¤×¨×˜×™ ×”×—×•××¨×” ×©×œ ××¢×‘×“ ×’×¨×¤×™ (GPU) ×•×“×¨×™×™×‘×¨×™× × ×—×©×¤×™×. ×§×•××‘×™× ×¦×™×” ×–×• ×©×œ ×¤×¨×˜×™× ×”×™× ×××•×“ ×™×™×—×•×“×™×ª ×•×××¤×©×¨×ª ×–×™×”×•×™ ×—×•×–×¨ ×©×œ×›×.',
                fix: '×”×©×‘×ª×” ××œ××” ×©×œ WebGL ×‘×”×’×“×¨×•×ª ×”×“×¤×“×¤×Ÿ (×× ××¤×©×¨×™) ××• ×©×™××•×© ×‘×“×¤×“×¤× ×™× ×”××˜×©×˜×©×™× × ×ª×•× ×™× ××œ×•.',
                critical: false
            },
            
            // ==== 3. ××—×¡×•×Ÿ ××§×•××™ ×•×¢×§×™×‘×•×ª ====
            HAS_COOKIES: {
                title: '×¢×•×’×™×•×ª ×§×™×™××•×ª (Cookies)',
                explanation: '× ××¦××• ×¢×•×’×™×•×ª ×©× ×©××¨×• ×¢×œ ×™×“×™ ×”××ª×¨×™× ×©×’×œ×©×ª× ×‘×”×. ×¢×•×’×™×•×ª ×—×™×•× ×™×•×ª ××š ××©××©×•×ª ×’× ×œ××¢×§×‘ ×•×¤×¨×¡×•×.',
                fix: '×”×¤×¢×™×œ×• × ×™×§×•×™ ××•×˜×•××˜×™ ×©×œ ×¢×•×’×™×•×ª ×¦×“ ×©×œ×™×©×™ (Third-Party Cookies) ×•×”×’×“×¨×ª ×”×“×¤×“×¤×Ÿ ×œ××—×™×§×ª ×¢×•×’×™×•×ª ×‘×¡×™×•× ×›×œ ×¡×©×Ÿ.',
                critical: false
            },
            HAS_LOCAL_STORAGE: {
                title: '×©×™××•×© ×‘-LocalStorage',
                explanation: '××•×‘×™×™×§×˜×™× ×××•×—×¡× ×™× ×‘××•×¤×Ÿ ×§×‘×•×¢ ×‘×–×™×›×¨×•×Ÿ ×”××§×•××™ ×©×œ ×”×“×¤×“×¤×Ÿ ××¢×‘×¨ ×œ×¡×©×Ÿ ×”× ×•×›×—×™. ×–×”×• ××§×•× × ×•×¡×£ ×œ×©××•×¨ × ×ª×•× ×™ ×¢×§×™×‘×”.',
                fix: '××•××œ×¥ ×œ××—×•×§ × ×ª×•× ×™ ××ª×¨ ×‘××•×¤×Ÿ ×§×‘×•×¢. ×‘×“×¤×“×¤× ×™× ××¡×•×™××™× (×›×’×•×Ÿ ×¤×™×™×¨×¤×•×§×¡), × ×™×ª×Ÿ ×œ×”×’×“×™×¨ ××—×™×§×ª × ×ª×•× ×™ ××—×¡×•×Ÿ ×›×©×™×•×¦××™× ××”××ª×¨.',
                critical: false
            },
            
            // ==== 5. ×¡×§×™×¨×ª ×¤×•×¨×˜×™× ====
            PORTS_REACHABLE: {
                title: '×¤×•×¨×˜×™× ××§×•××™×™× × ×™×ª× ×™× ×œ×”×©×’×”',
                explanation: '×”×“×¤×“×¤×Ÿ ×”×¦×œ×™×— ×œ×™×¦×•×¨ ×—×™×‘×•×¨ ××• ×œ×”×©×™×’ ×ª×’×•×‘×” ××”×™×¨×” ×œ×™×¦×™××•×ª (×¤×•×¨×˜×™×) ××§×•××™×•×ª ×‘××—×©×‘×›× (127.0.0.1). ×ª×•×§×£ ×™×›×•×œ ×œ× ×¦×œ ×–××ª ×›×“×™ ×œ××¤×•×ª ×©×™×¨×•×ª×™× ××§×•××™×™× ×¨×¦×™×.',
                fix: '×•×“××• ×©×—×•××ª ×”××© (Firewall) ×©×œ ×”××—×©×‘ ××•×’×“×¨×ª ×›×¨××•×™ ×œ×—×¡×•× ×’×™×©×” ×—×•×–×¨×ª ×œ×©×™×¨×•×ª×™× ××§×•××™×™× ××“×¤×“×¤× ×™×. ×›××• ×›×Ÿ, ×‘×˜×œ×• ××ª ×”×¤×¢×œ×ª ×”×¤×¨×•×˜×•×§×•×œ×™× ×”×¤×—×•×ª × ×“×¨×©×™× ×‘×¨××ª ××¢×¨×›×ª ×”×”×¤×¢×œ×”.',
                critical: true
            },
            
            // ==== 6. ××‘×˜×—×ª ×—×™×‘×•×¨ ====
            NO_HTTPS: {
                title: '×—×™×‘×•×¨ ×œ× ××•×¦×¤×Ÿ (HTTP)',
                explanation: '×”×—×™×‘×•×¨ ×œ××ª×¨ ×”× ×•×›×—×™ ××ª×‘×¦×¢ ×‘×¤×¨×•×˜×•×§×•×œ HTTP ×œ× ×××•×‘×˜×—. ×›×œ × ×ª×•×Ÿ ×”××•×¢×‘×¨ (×›×•×œ×œ ×ª×•×¦××•×ª ××œ×•, ×× ×”×™×• × ×©×œ×—×•×ª ×œ×©×¨×ª) ×—×©×•×£ ×œ×¦×™×ª×•×ª (Man-in-the-Middle).',
                fix: '×•×“××• ×©××ª× ×’×•×œ×©×™× ×ª××™×“ ×“×¨×š ×—×™×‘×•×¨ HTTPS ××•×¦×¤×Ÿ. ××•××œ×¥ ×œ×”×©×ª××© ×‘×ª×•×¡×¤×™× ×›×’×•×Ÿ "HTTPS Everywhere".',
                critical: true
            }
        };


        // === ×¤×•× ×§×¦×™×•×ª ×œ×™×¦×™×¨×ª ×§×©×¨ ===
        function resolveEmail(obfuscatedEmail) { return obfuscatedEmail.replace(/\[dot\]/g, '.').replace(/\[at\]/g, '@'); }
        function buildMailTo(email, subject, body) { return `mailto:${encodeURIComponent(email)}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`; }

        document.querySelector('#contactCard .contact .icon').addEventListener('click', () => {
             try {
                const realEmail = resolveEmail(CONFIG.CONTACT_EMAIL_OBFUSCATED);
                const mailto = buildMailTo(realEmail, "×¤× ×™×” ×-CyberScan Pro (×‘×“×™×§×” ×›×œ×œ×™×ª)", "×©×œ×•×,\n\n");
                window.location.href = mailto;
            } catch (e) {
                alert("×©×’×™××” ×‘×¤×ª×™×—×ª ×ª×•×›× ×ª ×“×•××¨: " + e.message);
            }
        });

        function handleContactSubmit(e) {
            e.preventDefault();
            try {
                const realEmail = resolveEmail(CONFIG.CONTACT_EMAIL_OBFUSCATED);
                const name = $('cf_name').value.trim() || 'Anonymous';
                const subj = $('cf_subject').value.trim();
                const msg = $('cf_message').value.trim();
                const body = `Sender Name: ${name}\n\nMessage Content:\n${msg}\n\n---\nSent from CyberScan Pro (Client-Side)`;
                const mailto = buildMailTo(realEmail, subj || "General Inquiry from CyberScan Pro", body);
                window.location.href = mailto;
            } catch (e) {
                alert("Error creating MailTo link: " + e.message);
            }
            return false;
        }

        // === ×¤×•× ×§×¦×™×•×ª ×¢×–×¨ ×œ-UI ×•××‘×˜×—×” ===

        function setBadge(id, text, cls) {
            const el = $(id);
            if (!el) return;
            el.className = `badge ${cls || 'neutral'}`;
            el.textContent = text;
            el.removeAttribute('data-i18n'); // ×‘×™×˜×•×œ ×ª×¨×’×•× ××•×˜×•××˜×™
        }

        function appendList(id, key, value, isBold = false) {
            const el = $(id);
            if (!el) return;

            const line = document.createElement('div');
            line.className = 'line';

            const keyDiv = document.createElement('div');
            keyDiv.textContent = key;
            line.appendChild(keyDiv);

            const valueDiv = document.createElement('div');
            const textNode = document.createElement(isBold ? 'strong' : 'span');
            textNode.textContent = String(value);
            valueDiv.appendChild(textNode);

            line.appendChild(valueDiv);
            el.appendChild(line);
        }

        function displayRecommendations(recsContainerId, recommendationKeys) {
            const container = $(recsContainerId);
            const lang = currentLang;
            const recsHeader = i18n[lang].recsHeader;
            const cleanRecText = i18n[lang].cleanRecText;

            container.innerHTML = `<h4>${recsHeader}</h4>`; 

            if (recommendationKeys.length === 0) {
                const div = document.createElement('div');
                div.className = 'recommend-item';
                div.innerHTML = `<strong>${cleanRecText.split(':')[0]}</strong><p>${cleanRecText.split(':')[1] || ''}</p>`;
                container.appendChild(div);
                return;
            }

            // Note: Explanation and Fix are only in Hebrew in RecommendationStore (as requested)
            recommendationKeys.forEach(key => {
                const rec = RecommendationStore[key];
                if (!rec) return;

                const recDiv = document.createElement('div');
                recDiv.className = `recommend-item ${rec.critical ? 'critical' : ''}`;
                // This uses HEBREW content from RecommendationStore
                recDiv.innerHTML = `
                    <strong>${rec.title} ${rec.critical ? ` (${lang === 'he' ? '×§×¨×™×˜×™!' : 'CRITICAL!'})` : ''}</strong>
                    <p>
                        **${lang === 'he' ? '×”×¡×‘×¨' : 'Explanation'}:** ${rec.explanation}
                        <br>
                        **${lang === 'he' ? '×¤×ª×¨×•×Ÿ' : 'Solution'}:** ${rec.fix}
                    </p>
                `;
                container.appendChild(recDiv);
            });
        }


        function clearAll() {
            // ... (clearAll logic is the same)
            const sections = ['publicIpList', 'webrtcList', 'dnsList', 'generalFpList', 'canvasFpList', 'webglFpList', 'cookiesList', 'storageList', 'browserList', 'hardwareList', 'timingList', 'portsList', 'tlsList'];
            sections.forEach(id => {
                const el = $(id);
                if (el) el.innerHTML = '';
            });

            const recs = ['networkRecs', 'fingerprintRecs', 'cookiesRecs', 'browserRecs', 'portsRecs', 'tlsRecs'];
            recs.forEach(id => {
                $(id).innerHTML = "";
            });

            const badges = ['networkBadge', 'fingerprintBadge', 'cookiesBadge', 'browserBadge', 'portsBadge', 'tlsBadge'];
            badges.forEach(b => setBadge(b, i18n[currentLang].untested, 'neutral'));

            $('privacyScore').textContent = 'â€”';
            $('statusBrief').textContent = i18n[currentLang].statusReady;
            $('statusBrief').removeAttribute('data-i18n'); // ×‘×™×˜×•×œ ×ª×¨×’×•× ××•×˜×•××˜×™
        }

        // === ×× ×’× ×•× ×™ ×”×‘×“×™×§×” (WebRTC, Fingerprint, Port Scan) â€“ ×”×§×•×“ × ×©××¨ ×›×¤×™ ×©×”×•×¢×‘×¨ ×§×•×“× ×œ×›×Ÿ ===
        
        async function gatherICE(timeout=3000){
            // ... (×§×•×“ WebRTC)
            return new Promise((resolve)=>{
                const ips = new Map();
                let pc;
                try{
                    pc = new RTCPeerConnection({iceServers:[{urls:['stun:stun.l.google.com:19302', 'stun:stun1.l.google.com:19302']}]});
                    pc.createDataChannel('d');
                    
                    pc.onicecandidate = e=>{
                        if(!e.candidate) return;
                        const cand = e.candidate.candidate;
                        const parts = cand.split(' ');
                        const ipCandidate = parts[4]; 
                        const typeCandidate = parts[7]; 
                        
                        if (ipCandidate && (ipCandidate.includes('.') || ipCandidate.includes(':'))) {
                            const isPrivate = ipCandidate.startsWith('10.') || ipCandidate.startsWith('172.') || ipCandidate.startsWith('192.168.') || ipCandidate.startsWith('fc00:');

                            let type = '××—×¨'; // Only in Hebrew 
                            if (typeCandidate === 'srflx') type = `×¦×™×‘×•×¨×™ (STUN) - ${isPrivate ? '×—×©×•×“' : '×’×œ×•×™'}`;
                            else if (typeCandidate === 'host') type = isPrivate ? '××§×•××™ (×¤×¨×˜×™)' : '××§×•××™ (Host)';
                            else if (typeCandidate === 'relay') type = '×××¡×¨ (TURN)';

                            ips.set(ipCandidate, {ip: ipCandidate, type: type});
                        }
                    };
                    
                    pc.onicegatheringstatechange = () => {
                        if (pc.iceGatheringState === 'complete') {
                            try { pc.close(); } catch (e) { /* noop */ }
                            resolve(Array.from(ips.values()));
                        }
                    };

                    pc.createOffer({offerToReceiveVideo: false, offerToReceiveAudio: false}).then(offer=>{
                        return pc.setLocalDescription(offer);
                    }).catch(err => {
                        try { pc.close(); } catch (e) { /* noop */ }
                        resolve([]);
                    });
                    
                    setTimeout(()=>{ try{ pc.close(); }catch(e){}; resolve(Array.from(ips.values())); }, timeout);

                }catch(err){ 
                    if(pc && pc.close) pc.close();
                    resolve([]); 
                }
            });
        }
        
        function getCanvasFingerprint() {
          // ... (×§×•×“ Canvas)
          if (!window.WebGLRenderingContext) { return '×œ× × ×ª××š (WebGL ×—×¡×¨)'; }
            try {
                const canvas = $('canvasTest');
                const ctx = canvas.getContext('2d');
                
                ctx.textBaseline = "top";
                ctx.font = '14px Arial (Canvas FP)';
                ctx.textStyle = '#f60';
                ctx.fillText("CyberScan Pro WebFP Test: 1.0 (Text)", 2, 2);
                
                ctx.fillStyle = '#0f0';
                ctx.fillRect(10, 10, 20, 20);
                
                const hash = btoa(ctx.getImageData(0, 0, canvas.width, canvas.height).data.toString()).substring(0, 32);

                return hash;
            } catch (e) {
                return `×©×’×™××” (Error: ${e.message.substring(0, 30)})`;
            }
        }
        
        function getWebGlInfo() {
          // ... (×§×•×“ WebGL)
          const info = {};
            const canvas = document.createElement('canvas');
            let gl;
            try {
                gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                if (gl) {
                    const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                    // ×”×©××˜×ª ×‘×“×™×§×ª debugInfo.UNMASKED_RENDERER/VENDOR_WEBGL ×›×™ ×œ× ×›×œ ×“×¤×“×¤×Ÿ ×××¤×©×¨ ×–××ª (×¤×¨×˜×™×•×ª).
                    info['Renderer'] = gl.getParameter(gl.RENDERER) || 'N/A';
                    info['Vendor'] = gl.getParameter(gl.VENDOR) || 'N/A';
                    info['Version'] = gl.getParameter(gl.VERSION) || 'N/A';
                } else {
                    info['Renderer'] = '×œ× × ×ª××š/×—×¡×•×';
                }
            } catch (e) {
                info['Renderer'] = `×©×’×™××” (${e.message.substring(0, 30)})`;
            }
            return info;
        }

        async function safePortScan(ports) {
            // ... (×§×•×“ Port Scan)
            const results = [];
            await Promise.all(ports.map(async p => {
                const url = `//${location.hostname}:${p}/`; // ×©×™× ×•×™ ×œ-URL ×™×—×¡×™
                const start = performance.now();
                
                // ×©×™××•×© ×‘-fetch ×¨×§ ×œ×‘×“×™×§×ª ×ª×’×•×‘×” ××§×•××™×ª ×‘-Client
                const fetchPromise = fetch(url, { method: 'GET', mode: 'no-cors', cache: 'no-store', redirect: 'error' });
                const timeoutPromise = new Promise(resolve => setTimeout(() => resolve({ error: 'Timeout' }), 400));
                
                const result = await Promise.race([fetchPromise, timeoutPromise]);
                const end = performance.now();
                
                let isReached = result && !result.error && (end - start) < 400; 
                
                results.push({ port: p, open: isReached });
            }));
            return results;
        }
        // ===================================


        // === ×¤×•× ×§×¦×™×™×ª ×”×¡×¨×™×§×” ×”×¨××©×™×ª ×”××¢×•×“×›× ×ª (×”×¨×¢×™×•× ×•×ª, ××š ×”-strings × ×©××¨×• ×‘-HE) ===
        // ×”×¢×¨×”: ×™×© ×¦×•×¨×š ×œ×”×©×ª××© ×‘-strings ×¢×‘×¨×™×™× ×›×™ ×”-RecommendationStore ×”×•× ×‘×¢×‘×¨×™×ª.

        async function runScan({extended = true}) {
            const lang = currentLang;
            clearAll();
            $('statusBrief').textContent = i18n[lang].statusScanning;
            let score = 100;

            // --- ××©×ª× ×™ ×“×’×œ×™× ×œ××™×¡×•×£ ×‘×¢×™×•×ª ---
            const networkRecs = [];
            const fpRecs = [];
            const cookieRecs = [];
            const portsRecs = [];
            const tlsRecs = [];
            // ---

            // ==========================================================
            // 1. ×¨×©×ª ×•-IP
            // ... (×”×‘×“×™×§×•×ª × ×©××¨×•×ª ×–×”×•×ª ××‘×—×™× ×” ×¤×•× ×§×¦×™×•× ×œ×™×ª)
            let networkIssues = 0;
            // 1.1) IP ×¦×™×‘×•×¨×™
            try {
                const resp = await fetch(CONFIG.IP_CHECK_API);
                if (resp.ok) {
                    const j = await resp.json();
                    appendList('publicIpList', 'IP ×¦×™×‘×•×¨×™', j.ip, true);
                    networkRecs.push('PUBLIC_IP_EXPOSED'); 
                } else throw new Error("API call failed");
            } catch (e) {
                appendList('publicIpList', 'IP ×¦×™×‘×•×¨×™', `×œ× ×–××™×Ÿ / × ×—×¡×`);
                networkIssues += 1;
                score -= 5;
            }

            // 1.2) WebRTC/ICE
            try {
                appendList('webrtcList', '--- WebRTC / ×“×œ×™×¤×ª IP ×¤×¨×˜×™ ---', '', false);
                const ips = await gatherICE(extended ? 5000 : 3000);
                let hasLocal = false;
                if (ips.length === 0) {
                    appendList('webrtcList', '××•×¢××“×™× ××§×•××™×™×/×¤×¨×˜×™×™×', '×œ× × ××¦××• (×›×›×œ ×”× ×¨××” ×”-WebRTC ×—×¡×•×)', true);
                } else {
                    ips.forEach(it => {
                        const key = it.type;
                        const isCritical = key.includes('×¤×¨×˜×™') || key.includes('Host');
                        appendList('webrtcList', key, it.ip, isCritical);
                        if (isCritical) hasLocal = true;
                    });
                }
                
                if (hasLocal) {
                    networkIssues += 2;
                    score -= 25;
                    networkRecs.push('WEBRTC_LOCAL_LEAK'); 
                }
            } catch (e) {
                appendList('webrtcList', '×©×’×™××ª ICE', '× ×›×©×œ×”, ×™×™×ª×›×Ÿ ×—×¡×™××”', false);
            }

            // 1.3) DNS (×‘×“×™×§×” ×—×œ×§×™×ª)
            try {
                 networkRecs.push('DNS_TRACING');
            
                appendList('dnsList', '--- ×‘×“×™×§×ª DNS (Cloudflare) ---', '', false);
                const r = await fetch(CONFIG.DNS_TRACE_API);
                if (r.ok) {
                    const text = await r.text();
                    const resolver = text.split('\n').find(l => l.startsWith('resolver='));
                    const dnsValue = resolver ? resolver.split('=')[1] : '×œ× × ××¦× ××™×“×¢';

                    appendList('dnsList', '×›×ª×•×‘×ª DNS (××ª×•×š CF)', dnsValue, true);
                    if (dnsValue !== '×œ× × ××¦× ××™×“×¢' && !(dnsValue.includes('1.1.1.1') || dnsValue.includes('8.8.8.8'))) {
                        score -= 8;
                    } 
                } else throw new Error("CF not reachable");
            } catch (e) {
                appendList('dnsList', '×©×¨×ª DNS ××–×”×”', '×‘×“×™×§×” × ×›×©×œ×” / × ×—×¡××”');
            }

            // ×¡×˜××˜×•×¡ ×¨×©×ª
            let networkIssuesCount = networkIssues;
            let networkStatus = networkIssuesCount === 0 ? 'good' : (networkIssuesCount >= 2 ? 'bad' : 'warn');
            let networkText = networkIssuesCount === 0 ? '× ×§×™' : (networkIssuesCount >= 2 ? '×¡×™×›×•×Ÿ ×’×œ×•×™' : '××–×”×¨×” ×§×œ×”');
            setBadge('networkBadge', networkText, networkStatus);
            displayRecommendations('networkRecs', networkRecs);


            // ==========================================================
            // 2. Web Fingerprinting
            // ...
            let fpIssues = 0;
            appendList('generalFpList', '--- ×˜×‘×™×¢×ª ××¦×‘×¢ ×›×œ×œ×™×ª ---', '', false);
            const fp = {
                'User Agent String': navigator.userAgent || '×—×¡×¨',
                '×©×¤×•×ª (Languages)': (navigator.languages || []).join(',') || navigator.language || '×—×¡×¨',
                '×¨×–×•×œ×•×¦×™×™×ª ×”××¡×š': `${screen.width}x${screen.height}x${screen.colorDepth}bit`,
                '×–×™×›×¨×•×Ÿ ×”×ª×§×Ÿ': `${navigator.deviceMemory || '× ×—×¡×'}GB`,
                '××¢×‘×“×™× ×œ×•×’×™×™×': navigator.hardwareConcurrency || '× ×—×¡×',
            };
            // ... (×©××¨ ×‘×“×™×§×•×ª Fingerprint ×–×”×•×ª)
            Object.entries(fp).forEach(([k, v]) => appendList('generalFpList', k, v, k.includes('Agent')));
            if (fp['User Agent String'] === navigator.userAgent) score -= 5;
            if(fp['××¢×‘×“×™× ×œ×•×’×™×™×'] !== '× ×—×¡×') fpRecs.push('GENERAL_FP_DATA_EXPOSED');

            if (extended) {
                appendList('canvasFpList', '--- ×˜×‘×™×¢×ª ××¦×‘×¢ (Canvas) ---', '', false);
                const canvasHash = getCanvasFingerprint();
                appendList('canvasFpList', 'Canvas Hash', canvasHash, true);
                if (!canvasHash.includes('×©×’×™××”') && !canvasHash.includes('×—×¡×¨')) {
                    score -= 15;
                    fpIssues += 1;
                    fpRecs.push('CANVAS_FINGERPRINT'); 
                }
            }

            if (extended) {
                appendList('webglFpList', '--- ×˜×‘×™×¢×ª ××¦×‘×¢ (WebGL) ---', '', false);
                const webglInfo = getWebGlInfo();
                Object.entries(webglInfo).forEach(([k, v]) => appendList('webglFpList', k, v, k.includes('Renderer')));
                if (webglInfo.Renderer && webglInfo.Renderer !== '×œ× × ×ª××š/×—×¡×•×' && webglInfo.Renderer !== 'N/A') {
                    score -= 10;
                    fpIssues += 1;
                    fpRecs.push('WEBGL_FINGERPRINT'); 
                }
            }

            let fpText = fpIssues === 0 ? '×‘×¡×™×¡×™ ×‘×œ×‘×“' : (fpIssues > 1 ? '×™×™×—×•×“×™ ×××•×“' : '×™×™×—×•×“×™');
            setBadge('fingerprintBadge', fpText, fpIssues === 0 ? 'good' : (fpIssues > 1 ? 'bad' : 'warn'));
            displayRecommendations('fingerprintRecs', fpRecs);


            // ==========================================================
            // 3. ××—×¡×•×Ÿ ××§×•××™ ×•×¢×§×™×‘×•×ª
            // ...
            let cookieIssues = 0;

            appendList('cookiesList', '--- ×¢×•×’×™×•×ª HTTP (Cookies) ---', '', false);
            try {
                const cookieStr = document.cookie || '';
                const keys = cookieStr.split(';').map(s => s.trim()).filter(Boolean);
                appendList('cookiesList', '×¡×”"×› ×¢×•×’×™×•×ª ×œ××ª×¨ ×–×”', keys.length, true);
                if (keys.length > 5) {
                    cookieIssues += 1;
                    cookieRecs.push('HAS_COOKIES');
                    score -= 6;
                }
            } catch (e) {}

            appendList('storageList', '--- ××—×¡×•×Ÿ ×‘×“×¤×“×¤×Ÿ (Storage) ---', '', false);
            try {
                appendList('storageList', 'LocalStorage Items', localStorage.length, localStorage.length > 0);
                appendList('storageList', 'SessionStorage Items', sessionStorage.length, sessionStorage.length > 0);
                if (localStorage.length > 10 || sessionStorage.length > 0) {
                    score -= 4;
                    cookieIssues += 0.5;
                    cookieRecs.push('HAS_LOCAL_STORAGE');
                }
            } catch (e) {
                appendList('storageList', '××™×¡×•×£ ××—×¡×•×Ÿ', '× ×—×¡× (×™×™×ª×›×Ÿ ×‘×”×’×“×¨×•×ª)', false);
            }

            let cookieStatus = cookieIssues === 0 ? 'good' : 'warn';
            setBadge('cookiesBadge', cookieIssues === 0 ? '× ×§×™ ×™×—×¡×™×ª' : '×¢×§×™×‘×•×ª ×§×™×™××ª', cookieStatus);
            displayRecommendations('cookiesRecs', cookieRecs);

            // ==========================================================
            // 4. ×¤×¨×˜×™ ×“×¤×“×¤×Ÿ ×•××¢×¨×›×ª
            // ... (×”×‘×“×™×§×•×ª × ×©××¨×•×ª ×–×”×•×ª)
            appendList('browserList', '--- ×¤×¨××˜×¨×™× ×‘×¡×™×¡×™×™× ---', '', false);
            try {
                appendList('browserList', '×¤×œ×˜×¤×•×¨××”', navigator.platform || '×œ× ×™×“×•×¢', true);
                appendList('browserList', '××–×•×¨ ×–××Ÿ (Timezone)', Intl.DateTimeFormat().resolvedOptions().timeZone || '×—×¡×¨', false);
                appendList('browserList', '××–×”×” ××¤×¢×™×œ (Vendor)', navigator.vendor || '×—×¡×¨', false);
            } catch (e) {}
            // ... (×©××¨ ×‘×“×™×§×•×ª ×“×¤×“×¤×Ÿ × ×©××¨×•×ª ×–×”×•×ª)

            setBadge('browserBadge', '× ×‘×“×§', 'neutral');
            displayRecommendations('browserRecs', []); 

            // ==========================================================
            // 5. ×¡×§×™×¨×ª ×¤×•×¨×˜×™×
            // ...
            let portIssues = 0;
            appendList('portsList', '--- ×¤×•×¨×˜×™× ×œ×¡×§×™×¨×” (127.0.0.1) ---', '', false);
             if (extended) {
                try {
                    const portResults = await safePortScan(CONFIG.COMMON_LOCAL_PORTS);
                    portResults.filter(r => r.open).sort((a, b) => a.port - b.port).forEach(r => {
                        appendList('portsList', `×¤×•×¨×˜ ${r.port}`, '××•×©×’! (Reached)', true);
                        portIssues += 1;
                    });
                    if (portIssues === 0) {
                        appendList('portsList', '×¡×˜×˜×•×¡ ×›×œ×œ×™', '×œ× × ××¦××• ×¤×•×¨×˜×™× ×¤×ª×•×—×™×', false);
                    }
                    if (portIssues > 0) {
                        score -= 15;
                        portsRecs.push('PORTS_REACHABLE'); 
                    }

                } catch (e) {
                    appendList('portsList', '×©×’×™××ª ×¡×¨×™×§×”', `× ×›×©×œ×” (Error: ${e.message.substring(0, 50)})`, true);
                }
            } else {
                appendList('portsList', '××¦×‘', '×‘×“×™×§×” ××§×™×¤×” ××™× ×” ×¤×¢×™×œ×” - ×œ×—×¥ "×‘×“×™×§×” ××§×™×¤×”"', false);
            }
            let portStatus = portIssues === 0 ? 'good' : 'bad';
            setBadge('portsBadge', portIssues === 0 ? '× ×§×™' : '×—×©×™×¤×” ××§×•××™×ª', portStatus);
            displayRecommendations('portsRecs', portsRecs);


            // ==========================================================
            // 6. ××‘×˜×—×ª ×—×™×‘×•×¨
            // ...
            try {
                appendList('tlsList', '--- ×‘×“×™×§×•×ª SSL/TLS ---', '', false);
                const isHttps = location.protocol === 'https:';
                appendList('tlsList', 'HTTPS ×‘××¢×¨×›×ª', isHttps ? '×¤×•×¢×œ ×•×××•×‘×˜×—' : '×œ× ×¤×¢×™×œ! ×¡×™×›×•×Ÿ', !isHttps);
                if (!isHttps) {
                    score -= 30;
                    tlsRecs.push('NO_HTTPS'); 
                }
            } catch (e) {}

            try {
                const hasMixedContent = location.protocol === 'https:' && (document.querySelector('a[href^="http:"]') || document.querySelector('img[src^="http:"]'));
                appendList('tlsList', 'Mixed Content (HTTP ×‘-HTTPS)', hasMixedContent ? '×§×™×©×•×¨×™× ×œ× ×××•×‘×˜×—×™× × ××¦××•' : '×œ× × ××¦×', hasMixedContent);
                if (hasMixedContent) score -= 5;
            } catch (e) {}
            
            let tlsStatus = location.protocol === 'https:' ? 'good' : 'bad';
            setBadge('tlsBadge', location.protocol === 'https:' ? '×××•×‘×˜×—' : '×œ× ×××•×‘×˜×—', tlsStatus);
            displayRecommendations('tlsRecs', tlsRecs);


            // ==========================================================
            // ×¡×™×•×
            // ==========================================================

            if (score < 0) score = 0;
            if (score > 100) score = 100;

            const scEl = $('privacyScore');
            scEl.textContent = score;
            scEl.style.color = score > 75 ? 'var(--good)' : (score > 45 ? 'var(--warn)' : 'var(--bad)');
            $('statusBrief').textContent = i18n[lang].statusComplete(score);

            document.querySelectorAll('.section').forEach(card => {
                const badge = card.querySelector('.badge');
                if (badge && (badge.classList.contains('bad') || badge.classList.contains('warn'))) {
                    card.classList.add('expanded');
                }
            });
        }


        // === ×”×¨×¦×” ×¨××©×•× ×™×ª ×•×”××–× ×” ×œ××™×¨×•×¢×™× ===

        document.addEventListener('DOMContentLoaded', () => {
            // 1. ×”×’×“×¨×ª ×©×¤×ª ×‘×¨×™×¨×ª ×”××—×“×œ
            setLanguage('he');
            
            // 2. ×”××–× ×” ×œ×‘×•×¨×¨ ×”×©×¤×•×ª
            const langSelector = $('langSelector');
            if (langSelector) {
                langSelector.addEventListener('change', (e) => {
                    setLanguage(e.target.value);
                });
            }

            // 3. ×”××–× ×” ×œ×›×¤×ª×•×¨ ×”×¡×¨×™×§×”
            $('fullBtn').addEventListener('click', () => runScan({
                extended: true
            }));

            // 4. ×”×•×“×¢×ª ××•×›× ×•×ª
            window.setTimeout(() => {
                $('statusBrief').textContent = i18n[currentLang].statusReady;
            }, 500);
        });
    </script>
</body>

</html>