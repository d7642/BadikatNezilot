<!doctype html>
<html lang="he" dir="rtl" data-theme="dark">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>CyberScan Pro â€” Client-Side Audit</title>
    <style>
        :root {
            --bg: #060709; --panel: #0f1216; --text-main: #e6eef6; --text-muted: #98a2ad;
            --accent: #d33b3b; --accent2: #1f6feb; --good: #39b54a; --warn: #ffb86b; --bad: #ff5c5c;
            --border: rgba(255, 255, 255, 0.08); --shadow: 0 8px 30px rgba(0,0,0,0.5);
        }
        [data-theme="light"] {
            --bg: #f5f7f9; --panel: #ffffff; --text-main: #1c1e21; --text-muted: #5f6672;
            --border: rgba(0, 0, 0, 0.1);
        }
        body { background: var(--bg); color: var(--text-main); font-family: system-ui, -apple-system, sans-serif; margin: 0; line-height: 1.5; }
        .app { max-width: 900px; margin: 20px auto; padding: 15px; }
        header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 25px; border-bottom: 1px solid var(--border); padding-bottom: 15px; }
        .logo-box { display: flex; align-items: center; gap: 15px; }
        .logo { width: 50px; height: 50px; background: linear-gradient(135deg, var(--accent), #8b1e1e); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 20px; }
        
        .controls { display: flex; gap: 10px; align-items: center; }
        .btn { padding: 10px 20px; border-radius: 8px; border: none; font-weight: 600; cursor: pointer; transition: 0.2s; font-size: 14px; display: flex; align-items: center; gap: 8px; }
        .btn-main { background: var(--accent); color: white; }
        .btn-sec { background: var(--panel); color: var(--text-main); border: 1px solid var(--border); }
        .btn:hover { filter: brightness(1.2); transform: translateY(-1px); }

        .disclaimer { background: rgba(255, 184, 107, 0.1); border-right: 4px solid var(--warn); padding: 15px; border-radius: 8px; margin-bottom: 20px; font-size: 13px; }
        
        .card { background: var(--panel); border: 1px solid var(--border); border-radius: 12px; margin-bottom: 15px; overflow: hidden; box-shadow: var(--shadow); }
        .card-head { padding: 15px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; background: rgba(255,255,255,0.02); }
        .card-body { padding: 0 15px; max-height: 0; overflow: hidden; transition: 0.3s ease-out; }
        .card.open .card-body { padding: 15px; max-height: 2000px; }
        
        .scan-item { padding: 10px 0; border-bottom: 1px solid var(--border); }
        .scan-item:last-child { border-bottom: none; }
        .status-badge { font-size: 11px; padding: 2px 8px; border-radius: 4px; text-transform: uppercase; font-weight: bold; }
        .status-good { background: rgba(57, 181, 74, 0.2); color: var(--good); }
        .status-warn { background: rgba(255, 184, 107, 0.2); color: var(--warn); }
        .status-bad { background: rgba(255, 92, 92, 0.2); color: var(--bad); }
        .status-info { background: rgba(31, 111, 235, 0.2); color: var(--accent2); }

        .item-details { font-size: 12px; color: var(--text-muted); margin-top: 5px; }
        #liveLogs { background: #000; color: #0f0; font-family: monospace; height: 120px; overflow-y: auto; padding: 10px; border-radius: 8px; font-size: 11px; margin-top: 20px; }
        
        @media (max-width: 600px) { header { flex-direction: column; align-items: flex-start; } }
    </style>
</head>
<body>

<div class="app">
    <header>
        <div class="logo-box">
            <div class="logo">CS</div>
            <div>
                <h1 style="margin:0; font-size:20px;">CyberScan Pro</h1>
                <small style="color:var(--text-muted)">Client-Side Security Auditor</small>
            </div>
        </div>
        <div class="controls">
            <div id="exportBtns" style="display:none; gap:8px;">
                <button onclick="downloadHTML()" class="btn btn-sec">ğŸ“„ ×“×•×— ×¢×‘×¨×™×ª</button>
                <button onclick="downloadJSON()" class="btn btn-sec">{ } JSON</button>
            </div>
            <button onclick="runScan()" class="btn btn-main" id="scanBtn">ğŸ” ×”×ª×—×œ ×¡×¨×™×§×”</button>
        </div>
    </header>

    <div class="disclaimer">
        <strong>âš ï¸ ×’×™×œ×•×™ × ××•×ª:</strong> ×¡×¨×™×§×” ×–×• ××ª×‘×¦×¢×ª ×‘×“×¤×“×¤×Ÿ ×‘×œ×‘×“ (Client-Side). ××™×Ÿ ×œ×¡×•×¨×§ ×’×™×©×” ×œ×”×’×“×¨×•×ª ×©×¨×ª ×¤× ×™××™×•×ª, ×›×•×ª×¨×•×ª HTTP ×©××™× ×Ÿ ×—×©×•×¤×•×ª ×œ-JS ××• ×œ××¡×“ ×”× ×ª×•× ×™×. ×”×××¦××™× ×”× ××™× ×“×™×§×¦×™×” ×‘×œ×‘×“.
    </div>

    <div id="results">
        </div>

    <div id="liveLogs"></div>
</div>

<script>
    const $ = id => document.getElementById(id);
    let lastScanData = null;

    // ×¤×•× ×§×¦×™×™×ª ×”×’× ×” ××¤× ×™ XSS ×‘×“×•×—
    function escapeHTML(str) {
        const div = document.createElement('div');
        div.textContent = str;
        return div.innerHTML;
    }

    function log(msg) {
        const line = document.createElement('div');
        line.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
        $('liveLogs').prepend(line);
    }

    const CHECKS = [
        {
            id: 'https',
            cat: 'Security',
            title: '×¤×¨×•×˜×•×§×•×œ HTTPS',
            check: () => ({ val: location.protocol === 'https:' ? '×¤×¢×™×œ' : '×œ× ×¤×¢×™×œ', res: location.protocol === 'https:' ? 'good' : 'bad' }),
            impact: '×”×¦×¤× ×ª × ×ª×•× ×™× ×‘××¢×‘×¨.',
            mitigation: '×—×•×‘×” ×œ×”×©×ª××© ×‘×ª×¢×•×“×ª SSL.'
        },
        {
            id: 'csp',
            cat: 'Security',
            title: '×–×™×”×•×™ CSP (Meta)',
            check: () => {
                const meta = document.querySelector('meta[http-equiv="Content-Security-Policy"]');
                return { val: meta ? '× ××¦××” ×ª×’×™×ª Meta' : '×œ× × ××¦××” ×ª×’×™×ª Meta', res: meta ? 'good' : 'warn' };
            },
            impact: '×× ×™×¢×ª ×”×–×¨×§×ª ×§×•×“ (XSS).',
            mitigation: '××•××œ×¥ ×œ×”×’×“×™×¨ CSP ×‘×›×•×ª×¨×•×ª ×”×©×¨×ª (×œ× ×ª××™×“ × ×’×™×© ×œ-JS).'
        },
        {
            id: 'innerhtml',
            cat: 'Security',
            title: '×©×™××•×© ×‘-innerHTML',
            check: () => ({ val: '×‘×“×™×§×ª ×§×•×“ ×¡×˜×˜×™×ª', res: 'info' }),
            impact: '×¡×™×›×•×Ÿ ×¤×•×˜× ×¦×™××œ×™ ×œ×”×–×¨×§×ª DOM.',
            mitigation: '×”×¢×“×£ ×©×™××•×© ×‘-textContent ×¢×œ ×¤× ×™ innerHTML.'
        },
        {
            id: 'canvas_fp',
            cat: 'Privacy',
            title: '×˜×‘×™×¢×ª ××¦×‘×¢ (Canvas)',
            check: () => ({ val: '×“×¤×“×¤×Ÿ ×××¤×©×¨ ×–×™×”×•×™ ×’×¨×¤×™', res: 'warn' }),
            impact: '×™×›×•×œ×ª ×©×œ ××ª×¨×™× ×œ×–×”×•×ª ××ª ×”××©×ª××© ×‘××•×¤×Ÿ ×™×™×—×•×“×™.',
            mitigation: '×ª×›×•× ×” ×©×œ ×”×“×¤×“×¤×Ÿ, × ×™×ª×Ÿ ×œ×—×¡×•× ×‘×××¦×¢×•×ª ×ª×•×¡×¤×™ ×¤×¨×˜×™×•×ª.'
        },
        {
            id: 'cookies_secure',
            cat: 'Info',
            title: '××—×¡×•×Ÿ ×¢×•×’×™×•×ª (Client-Side)',
            check: () => ({ val: '×œ× × ×™×ª×Ÿ ×œ××™××•×ª ××œ× ×‘-JS', res: 'info' }),
            impact: '×¢×•×’×™×•×ª ××¡×•×’ HttpOnly ××•×¡×ª×¨×•×ª ××”×“×¤×“×¤×Ÿ ××¡×™×‘×•×ª ××‘×˜×—×”.',
            mitigation: '×™×© ×œ×•×•×“× ×”×’×“×¨×ª Secure ×•-HttpOnly ×‘×©×¨×ª.'
        },
        {
            id: 'hsts',
            cat: 'Info',
            title: '×‘×“×™×§×ª HSTS',
            check: () => ({ val: '×œ× × ×’×™×© ×œ-JavaScript', res: 'info' }),
            impact: '××›×™×¤×ª ×—×™×‘×•×¨ ×××•×‘×˜×— ×‘×œ×‘×“.',
            mitigation: '×× ×•×”×œ ×‘×¨××ª ×”-Header ×©×œ ×”×©×¨×ª ×‘×œ×‘×“.'
        }
    ];

    async function runScan() {
        log("××ª×—×™×œ ×¡×¨×™×§×” ×××•×‘×˜×—×ª...");
        $('scanBtn').disabled = true;
        $('results').innerHTML = '';
        
        lastScanData = {
            time: new Date().toLocaleString('he-IL'),
            items: [],
            disclaimer: "Client-side scan only. Server headers not verified."
        };

        const cats = { 'Security': 'ğŸ›¡ï¸ ××‘×˜×—×ª ×××©×§', 'Privacy': 'ğŸ•µï¸ ×¤×¨×˜×™×•×ª ×•××¢×§×‘', 'Info': 'â„¹ï¸ ××™×“×¢ ×˜×›× ×™' };
        
        for (const [catId, catName] of Object.entries(cats)) {
            const card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
                <div class="card-head" onclick="this.parentElement.classList.toggle('open')">
                    <strong>${catName}</strong>
                    <span>â–¼</span>
                </div>
                <div class="card-body" id="cat-${catId}"></div>
            `;
            $('results').appendChild(card);
        }

        for (const check of CHECKS) {
            const { val, res } = await check.check();
            const item = { ...check, val, res };
            lastScanData.items.push(item);

            const div = document.createElement('div');
            div.className = 'scan-item';
            div.innerHTML = `
                <div style="display:flex; justify-content:space-between;">
                    <strong>${escapeHTML(check.title)}</strong>
                    <span class="status-badge status-${res}">${res}</span>
                </div>
                <div class="item-details">
                    <div>×ª×•×¦××”: ${escapeHTML(val)}</div>
                    <div style="margin-top:4px;">ğŸ’¡ ${escapeHTML(check.impact)}</div>
                </div>
            `;
            $(`cat-${check.cat}`).appendChild(div);
            log(`×‘×“×™×§×ª ${check.title} ×”×¡×ª×™×™××”.`);
        }

        $('exportBtns').style.display = 'flex';
        $('scanBtn').disabled = false;
        log("×¡×¨×™×§×” ×”×•×©×œ××” ×‘×”×¦×œ×—×”.");
    }

    function downloadJSON() {
        const blob = new Blob([JSON.stringify(lastScanData, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `CyberScan_Report.json`;
        a.click();
    }

    function downloadHTML() {
        let rows = lastScanData.items.map(i => `
            <div style="border-bottom:1px solid #eee; padding:10px;">
                <strong style="color:#d33b3b">${i.title}</strong> [${i.res}]<br>
                <small>×××¦×: ${i.val}</small><br>
                <small>×”××œ×¦×”: ${i.mitigation}</small>
            </div>
        `).join('');

        const html = `
            <html dir="rtl">
            <body style="font-family:sans-serif; padding:40px;">
                <h1>×“×•×— ×¡×¨×™×§×” - CyberScan Pro</h1>
                <p>×ª××¨×™×š: ${lastScanData.time}</p>
                <p style="background:#fff3cd; padding:10px;">${lastScanData.disclaimer}</p>
                ${rows}
            </body>
            </html>
        `;
        const blob = new Blob([html], { type: 'text/html' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `CyberScan_Report.html`;
        a.click();
    }
</script>

</body>
</html>
